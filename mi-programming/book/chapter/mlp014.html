<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="mlp014_files/filelist.xml">
<title>Password Encryption on the AS/400</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Leif Svalgaard</o:Author>
  <o:LastAuthor>BOS Theo</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>717</o:TotalTime>
  <o:LastPrinted>2000-10-02T07:35:00Z</o:LastPrinted>
  <o:Created>2021-07-07T07:55:00Z</o:Created>
  <o:LastSaved>2021-07-07T07:55:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>6208</o:Words>
  <o:Characters>34145</o:Characters>
  <o:Company>Dell Computer Corporation</o:Company>
  <o:Lines>284</o:Lines>
  <o:Paragraphs>80</o:Paragraphs>
  <o:CharactersWithSpaces>40273</o:CharactersWithSpaces>
  <o:Version>16.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=themeData href="mlp014_files/themedata.thmx">
<link rel=colorSchemeMapping href="mlp014_files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ActiveWritingStyle Lang="EN-US" VendorID="8" DLLVersion="513" NLCheck="0">1</w:ActiveWritingStyle>
  <w:GrammarState>Clean</w:GrammarState>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>NL</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
   <w:UseWord97LineBreakingRules/>
   <w:SelectEntireFieldWithStartOrEnd/>
   <w:UseWord2002TableStyleRules/>
   <w:UseWord2010TableStyleRules/>
   <w:DontUseIndentAsNumberingTabStop/>
   <w:FELineBreak11/>
   <w:WW11IndentRules/>
   <w:DontAutofitConstrainedTables/>
   <w:AutofitLikeWW11/>
   <w:UnderlineTabInNumList/>
   <w:HangulWidthLikeWW11/>
   <w:UseNormalStyleForList/>
   <w:DontVertAlignCellWithSp/>
   <w:DontBreakConstrainedForcedTables/>
   <w:DontVertAlignInTxbx/>
   <w:Word11KerningPairs/>
   <w:CachedColBalance/>
  </w:Compatibility>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="false"
  DefSemiHidden="false" DefQFormat="false" DefPriority="99"
  LatentStyleCount="376">
  <w:LsdException Locked="false" Priority="0" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 9"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="header"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footer"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index heading"/>
  <w:LsdException Locked="false" Priority="35" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of figures"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope return"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="line number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="page number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of authorities"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="macro"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="toa heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 5"/>
  <w:LsdException Locked="false" Priority="10" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Closing"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Signature"/>
  <w:LsdException Locked="false" Priority="0" SemiHidden="true"
   UnhideWhenUsed="true" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Message Header"/>
  <w:LsdException Locked="false" Priority="11" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Salutation"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Date"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Note Heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Block Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="FollowedHyperlink"/>
  <w:LsdException Locked="false" Priority="22" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Document Map"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Plain Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="E-mail Signature"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Top of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Bottom of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal (Web)"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Acronym"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Cite"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Code"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Definition"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Keyboard"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Preformatted"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Sample"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Typewriter"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Variable"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Table"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation subject"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="No List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Contemporary"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Elegant"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Professional"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Balloon Text"/>
  <w:LsdException Locked="false" Priority="39" Name="Table Grid"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Theme"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" QFormat="true"
   Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" QFormat="true"
   Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" QFormat="true"
   Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" QFormat="true"
   Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" QFormat="true"
   Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" QFormat="true"
   Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" SemiHidden="true"
   UnhideWhenUsed="true" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="TOC Heading"/>
  <w:LsdException Locked="false" Priority="41" Name="Plain Table 1"/>
  <w:LsdException Locked="false" Priority="42" Name="Plain Table 2"/>
  <w:LsdException Locked="false" Priority="43" Name="Plain Table 3"/>
  <w:LsdException Locked="false" Priority="44" Name="Plain Table 4"/>
  <w:LsdException Locked="false" Priority="45" Name="Plain Table 5"/>
  <w:LsdException Locked="false" Priority="40" Name="Grid Table Light"/>
  <w:LsdException Locked="false" Priority="46" Name="Grid Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="Grid Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="Grid Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="46" Name="List Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="List Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="List Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Mention"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Smart Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hashtag"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Unresolved Mention"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Smart Link"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;
	mso-font-alt:"Courier New";
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536869121 1107305727 33554432 0 415 0;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-2147482993 6144 0 0 31 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:EN-US;}
h1
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:center;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	mso-list:l1 level1 lfo2;
	font-size:14.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:14.0pt;
	mso-ansi-language:EN-US;
	mso-bidi-font-weight:normal;}
h2
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	mso-list:l1 level2 lfo2;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
h3
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	mso-list:l1 level3 lfo2;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;
	font-weight:normal;}
h4
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	mso-list:l1 level4 lfo2;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;
	mso-bidi-font-weight:normal;}
h5
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:5;
	mso-list:l1 level5 lfo2;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman",serif;
	mso-ansi-language:EN-US;
	font-weight:normal;}
h6
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:6;
	mso-list:l1 level6 lfo2;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman",serif;
	mso-ansi-language:EN-US;
	font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:7;
	mso-list:l1 level7 lfo2;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:8;
	mso-list:l1 level8 lfo2;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:9;
	mso-list:l1 level9 lfo2;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;
	font-weight:bold;
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-noshow:yes;
	mso-style-unhide:no;
	margin:0cm;
	text-align:justify;
	mso-pagination:widow-orphan;
	tab-stops:center 216.0pt right 432.0pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:EN-US;}
a:link, span.MsoHyperlink
	{mso-style-noshow:yes;
	mso-style-unhide:no;
	color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-noshow:yes;
	mso-style-unhide:no;
	color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{mso-style-noshow:yes;
	mso-style-unhide:no;
	margin:0cm;
	mso-pagination:widow-orphan;
	font-size:8.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Lucida Console";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;}
p.Preformatted, li.Preformatted, div.Preformatted
	{mso-style-name:Preformatted;
	mso-style-unhide:no;
	margin:0cm;
	mso-pagination:widow-orphan;
	tab-stops:0cm 47.95pt 95.9pt 143.85pt 191.8pt 239.75pt 287.7pt 335.65pt 383.6pt 431.55pt 479.5pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;
	mso-fareast-language:EN-US;
	layout-grid-mode:line;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;}
 /* Page Definitions */
 @page
	{mso-footnote-separator:url("mlp014_files/header.html") fs;
	mso-footnote-continuation-separator:url("mlp014_files/header.html") fcs;
	mso-endnote-separator:url("mlp014_files/header.html") es;
	mso-endnote-continuation-separator:url("mlp014_files/header.html") ecs;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:50.4pt;
	mso-page-numbers-chapter-style:header-1;
	mso-even-footer:url("mlp014_files/header.html") ef1;
	mso-footer:url("mlp014_files/header.html") f1;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 @list l0
	{mso-list-id:-125;
	mso-list-type:simple;
	mso-list-template-ids:1851923066;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l1
	{mso-list-id:878395312;
	mso-list-template-ids:1741836368;}
@list l1:level1
	{mso-level-start-at:14;
	mso-level-style-link:"Heading 1";
	mso-level-suffix:space;
	mso-level-text:"Chapter %1";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level2
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 2";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level3
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 3";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level4
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 4";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level5
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 5";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level6
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 6";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level7
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 7";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level8
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 8";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level9
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 9";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050">
  <o:colormenu v:ext="edit" fillcolor="none"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=NL link=blue vlink=purple style='tab-interval:36.0pt;word-wrap:break-word'>

<div class=WordSection1>

<h1 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level1 lfo2'><![if !supportLists]><span
lang=EN-US style='mso-fareast-font-family:Arial;mso-bidi-font-family:Arial'><span
style='mso-list:Ignore'>Chapter 14 </span></span><![endif]><span lang=EN-US><br>
</span><span lang=EN-US style='font-size:10.0pt'><br>
</span><span lang=EN-US>Password Encryption on the AS/400</span></h1>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><a
name="_Toc492915802"><span lang=EN-US>Password Protected Access</span></a></h2>

<p class=MsoNormal><span lang=EN-US>The lowly password is still the main
barrier to unauthorized access to the AS/400. In a more innocent age, the S/38
stored user names and passwords in the clear in an independent index object called
the <i style='mso-bidi-font-style:normal'>Authorized User Table</i>: </span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console";color:maroon'>QSYUPTBL</span></b><span
lang=EN-US> in library </span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>QSYS</span></b><span lang=EN-US>. The AS/400 still stores this
information in the same place, but the password is no longer stored in the
clear but is weakly encrypted. A fair amount of disinformation has been spread
around about this issue. Below is a quote from News 3X/400 [August 1994, pg.
83] (well-known author’s name withheld):</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:4.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:21.6pt;margin-bottom:
0cm;margin-left:21.6pt;margin-bottom:.0001pt'><span lang=EN-US>“It is virtually
impossible to hack your way into an AS/400’s password file. Even the most
capable non-Rochester AS/400 programmers are thwarted in their efforts to find
where the AS/400 stores passwords. And if someone does manage to uncover the
physical location of the password file, the fun has just begun. Because OS/400
implements a scheme of double encryption for passwords (i.e. OS/400 encrypts
the password with one key, encrypts the encryption with a different key, and
then stores the result on disk), to find passwords, you would have to know not
only both encryption keys but the encryption algorithm used).” </span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>In this chapter we shall dispel some of the
mystery and tell the sad truth about password encryption on the AS/400. All of
this information is already public knowledge, so no deep secrets are being
revealed. It is likely (one may be allowed to hope) that this chapter will soon
become obsolete as IBM shores up password security on the iSeries/400.</span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>Password Rules</span></h2>

<p class=MsoNormal><span lang=EN-US>Passwords can be up to ten characters long
and consist of the capital letters <i style='mso-bidi-font-style:normal'>A</i>
through <i style='mso-bidi-font-style:normal'>Z</i>, the digits <i
style='mso-bidi-font-style:normal'>0</i> through <i style='mso-bidi-font-style:
normal'>9</i>, and the four characters pound (<i style='mso-bidi-font-style:
normal'>#</i>), dollar (<i style='mso-bidi-font-style:normal'>$</i>),
underscore (<i style='mso-bidi-font-style:normal'>_</i>), and the at sign (<i
style='mso-bidi-font-style:normal'>@</i>). The first character cannot be a
digit. There is a slight complication for code pages other than English because
national language characters are mapped onto these four special characters in a
rather arbitrary and <i style='mso-bidi-font-style:normal'>ad hoc</i> manner.
Having a limited set of characters is a <i style='mso-bidi-font-style:normal'>severe</i>
weakness, as the possible search space becomes much smaller. For the first
character we have 30 possible values, for each of the rest we have 40 possible
values, for a total of </span><span lang=EN-US style='mso-fareast-language:
EN-US;layout-grid-mode:line'>30*(40<sup>10</sup>-1)/(40-1)=</span><span
lang=EN-US style='font-family:"Arial",sans-serif;mso-bidi-font-family:"Times New Roman";
mso-fareast-language:EN-US;layout-grid-mode:line'> </span><span lang=EN-US
style='mso-fareast-language:EN-US;layout-grid-mode:line'>8.066*10<sup>15</sup></span><sup><span
lang=EN-US style='font-family:"Arial",sans-serif;mso-bidi-font-family:"Times New Roman";
mso-fareast-language:EN-US;layout-grid-mode:line'> </span></sup><span
lang=EN-US>possible passwords. Large as this number is, it is still millions of
times smaller than the full search space without restrictions on characters. As
we shall see, the encryption is executed so poorly that a further factor of
more than 64,000 is lost making brute-force decryption possible in a few hours.
This is not entirely IBM’s fault. Most of the blame for this should be placed
on Microsoft.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>There are many system values that control
additional rules for forming a valid password. One of my favorites is “The </span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console";color:maroon'>QPWDMAXLEN</span><span
lang=EN-US> </span></b><span lang=EN-US>system value controls the maximum
number of characters in a password. This provides additional [<i
style='mso-bidi-font-style:normal'>sic</i>] security by preventing users from
specifying passwords that are too long”. [IBM SC41-8083-02, Application
System/400, Security Reference, pg. 3-6]. Any of the other rules that prohibit
certain character combinations or limit the use of certain constructs all
reduce the search space and thus weakens the encryption.</span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>Retrieving the Encrypted Password</span></h2>

<p class=MsoNormal><span lang=EN-US>The </span><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Lucida Console";color:maroon'>QSYRUPWD</span></b><span lang=EN-US>
API retrieves the encrypted password information for a given user profile. The
API is entry 5723 in the SEPT (see appendix D). This API works with the Set
Encrypted User Password (</span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>QSYSUPWD</span></b><span lang=EN-US>) API in that the APIs allow
the administrator to more easily mirror the user profile activity on a second
system based on the activity at the first system. The manual describes this
information in a rather circumspect way as follows: The number of bytes of data
available to be returned to the caller may increase from release to release but
will always be a minimum of 2000 bytes. If the bytes available field is greater
than the bytes returned field, the receiver variable cannot successfully be
used as input to the </span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>QSYSUPWD</span></b><span lang=EN-US> API as not all encrypted
password data will be returned by this API.</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The </span><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Lucida Console";color:maroon'>MIRTVEPW</span></b><span lang=EN-US>
program retrieves the encrypted password information and shows the hexadecimal
representation of the information:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='color:green'>44 </span><span lang=EN-US style='color:red'>1C26CBC1C4910CFCD71BC19F694F7FEF
</span><span lang=EN-US style='color:blue'>3117672E0EC27808ADD5B1A41F2CB2C0<o:p></o:p></span></b></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='font-size:6.0pt;mso-bidi-font-size:10.0pt;color:blue'><o:p>&nbsp;</o:p></span></b></p>

<p class=MsoNormal><span lang=EN-US>We have split the information into three
fields for reasons that will become clear shortly.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Here is the program. It is set up to
retrieve my own encrypted password:</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .RECEIVER INIT(RECEIVER);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD<span
style='mso-spacerun:yes'>      </span>RECEIVER CHAR(2000);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD<span style='mso-spacerun:yes'>  </span>RCV-BYTES-RETURNED<span
style='mso-spacerun:yes'>  </span>BIN(4) DEF(RECEIVER) POS( 1);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD<span style='mso-spacerun:yes'>  </span>RCV-BYTES-AVAILABLE BIN(4)
DEF(RECEIVER) POS( 5);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD<span style='mso-spacerun:yes'>  </span>RCV-USER-PROFILE<span
style='mso-spacerun:yes'>  </span>CHAR(10) DEF(RECEIVER) POS( 9);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD<span style='mso-spacerun:yes'>  </span>RCV-DATA<span
style='mso-spacerun:yes'>         </span>CHAR(100) DEF(RECEIVER) POS(19);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .LENGTH<span
style='mso-spacerun:yes'>   </span>INIT(LENGTH);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD<span
style='mso-spacerun:yes'>      </span>LENGTH<span style='mso-spacerun:yes'>  
</span>BIN(4)<span style='mso-spacerun:yes'>   </span>INIT(2000);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .FORMAT<span
style='mso-spacerun:yes'>   </span>INIT(FORMAT);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD<span
style='mso-spacerun:yes'>      </span>FORMAT<span style='mso-spacerun:yes'>  
</span>CHAR(8)<span style='mso-spacerun:yes'>  </span>INIT(&quot;<b
style='mso-bidi-font-weight:normal'><span style='color:green'>UPWD0100</span></b>&quot;);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .USER<span
style='mso-spacerun:yes'>     </span>INIT(USER);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD<span
style='mso-spacerun:yes'>      </span>USER<span style='mso-spacerun:yes'>    
</span>CHAR(10) INIT(&quot;<b style='mso-bidi-font-weight:normal'><span
style='color:red'>LSVALGAARD</span></b>&quot;);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .ERROR<span
style='mso-spacerun:yes'>    </span>INIT(ERROR);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD<span
style='mso-spacerun:yes'>      </span>ERROR<span style='mso-spacerun:yes'>   
</span>BIN(4)<span style='mso-spacerun:yes'>   </span>INIT(0);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL OL QSYRUPWD (.RECEIVER, .LENGTH,
.FORMAT, .USER, .ERROR);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CALLX<span style='mso-spacerun:yes'>      </span>.SEPT(5723), QSYRUPWD,
*;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CVTHC<span style='mso-spacerun:yes'>       </span>MSG-TEXT,
RCV-DATA(1:35);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CALLI<span style='mso-spacerun:yes'>       </span>SHOW-MESSAGE, *,
.SHOW-MESSAGE;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>RTX<span style='mso-spacerun:yes'>         </span>*;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>%INCLUDE SHOWMSG</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>We can compare the data returned with the
contents of my entry in </span><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>QSYUPTBL</span><span
lang=EN-US>:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt'>000000<span style='mso-spacerun:yes'>  </span>D5D3E2E5 C1D3C7C1
C1D9C440 40404040<span style='mso-spacerun:yes'>  </span>40<b style='mso-bidi-font-weight:
normal'><span style='color:red;background:yellow;mso-highlight:yellow'>1C26CB
C1C4910C FCD71BC1 9F694F7F</span></b><span style='mso-spacerun:yes'>  </span>*N<b
style='mso-bidi-font-weight:normal'>LSVALGAARD</b><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt'>000020<span style='mso-spacerun:yes'>  </span><b style='mso-bidi-font-weight:
normal'><span style='color:red;background:yellow;mso-highlight:yellow'>EF</span></b>404040
40404040 40404000 4001F440<span style='mso-spacerun:yes'>  </span>00000000
00000000 1B478474 93000800<b style='mso-bidi-font-weight:normal'><span
style='mso-spacerun:yes'>  </span></b>*Õ<span
style='mso-spacerun:yes'>          </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt'>000040<span style='mso-spacerun:yes'>  </span>00000000 00000000
81151A7B 51330000<span style='mso-spacerun:yes'>  </span><b style='mso-bidi-font-weight:
normal'><span style='color:green;background:yellow;mso-highlight:yellow'>44</span></b>0000<b
style='mso-bidi-font-weight:normal'><span style='color:blue;background:yellow;
mso-highlight:yellow'>31 17672E0E C27808AD D5B1A41F</span></b><span
style='mso-spacerun:yes'>  </span>*<span style='mso-spacerun:yes'>       
</span>a<span style='mso-spacerun:yes'>  </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt'>000060<span style='mso-spacerun:yes'>  </span><b style='mso-bidi-font-weight:
normal'><span style='color:blue;background:yellow;mso-highlight:yellow'>2CB2C0</span></b>00
60404040 40404040 40404040<span style='mso-spacerun:yes'>  </span>40404040
40404040 00000040 40404040<b style='mso-bidi-font-weight:normal'><span
style='mso-spacerun:yes'>  </span></b>* ¥{ -<span
style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt'>000080<span style='mso-spacerun:yes'>  </span>40404040 40404040
40404040 40404040<span style='mso-spacerun:yes'>  </span>40404040 40404040
40404040 40404040<b style='mso-bidi-font-weight:normal'><span
style='mso-spacerun:yes'>  </span></b>*<span
style='mso-spacerun:yes'>           </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>It is at once apparent that there are <i
style='mso-bidi-font-style:normal'>two </i>16-byte encrypted passwords. If I
change my password, both of these values change as well. The x‘</span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:8.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console";color:green'>44</span></b><span
lang=EN-US>’ is not part of the encrypted passwords, but represents possibly an
indicator specifying which encryption methods are being used. In order not to
give my password away, I’ve changed it momentarily to be equal to my user name.
In V5R1 and later there are three encryptions of the password.</span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>Algorithm for the 1<sup>st</sup> Encrypted Password</span></h2>

<p class=MsoNormal><span lang=EN-US>The algorithm for computing the first
encrypted password is given by Murphy, Rieth and Stevens of IBM Corporation. An
explanation of this particular algorithm is freely available as an upgrade of
RFC 1205 at <a
href="http://www.ietf.org/internet-drafts/draft-ietf-tn3270e-tn5250e-05.txt">http://www.ietf.o<span
style='mso-bookmark:_Hlt494939680'>r</span>g/internet-drafts/draft-ietf-tn3270e-t<span
style='mso-bookmark:_Hlt494943499'>n</span>5<span style='mso-bookmark:_Hlt494947423'>2</span>50e-<i
style='mso-bidi-font-style:normal'>05.</i>t<span style='mso-bookmark:_Hlt494943252'>x</span>t</a><![if !supportNestedAnchors]><a
name="_Hlt494943252"></a><a name="_Hlt494947423"></a><a name="_Hlt494943499"></a><a
name="_Hlt494939680"></a><![endif]> The <i style='mso-bidi-font-style:normal'>05</i>.txt
suffix may change over time. It was <i style='mso-bidi-font-style:normal'>04</i>.txt,
and before that <i style='mso-bidi-font-style:normal'>03</i>.txt…</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>We quote part of their description here:</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>[…] Client
Access uses well-known <a href="http://www.itl.nist.gov/fipspubs/fip46-2.htm">DES</a>
encryption algorithms to create encrypted passwords. A client can generate
compatible encrypted passwords if they follow these steps, details of which can
be found in the Federal Information Processing Standards 46-2.</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:6.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>1. </span><span
lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>Padded_PW</span><span
lang=EN-US> = Left justified user password padded to the right with '40'X to 8
bytes. The users password must be left justified in an 8 byte variable and
padded to the right with '40'X up to an 8 byte length. If the user’s password
is 8 bytes in length, no padding would occur. For computing password
substitutes for passwords of length 9 and 10 see […] below. If the password is
not in EBCDIC, it must be converted to EBCDIC uppercase. </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:6.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>2. </span><span
lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>XOR_PW</span><span
lang=EN-US> = </span><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>Padded_PW</span><span lang=EN-US> xor
'5555555555555555'X The padded password is Exclusive OR'ed with 8 bytes of
'55'X. [this simply inverts the value of every second bit]</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>3. </span><span
lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>SHIFT_RESULT
= XOR_PW &lt;&lt; 1</span><span lang=EN-US>. The entire 8-byte result is
shifted 1 bit to the left; the leftmost bit value is discarded, and the
rightmost bit value is cleared to 0. </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:6.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>4. </span><span
lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>PW_TOKEN</span><span
lang=EN-US> = </span><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DES_ECB_mode</span><span lang=EN-US>(</span><span
lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>SHIFT_RESULT</span><span
lang=EN-US>, <span style='color:green'>/*key*/ </span></span><span lang=EN-US
style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>userID_in_EBCDIC_uppercase</span><span
lang=EN-US> <span style='color:green'>/*data*/</span> ) This shifted result is
used as key to the Data Encryption Standard […] to encipher the user
identifier. When the user identifier is less than 8 bytes, it is left justified
in an 8 byte variable and padded to the right with '40'X. When the user
identifier is 9 or 10 bytes, it is first padded to the right with '40'X to a
length of 10 bytes. Then bytes 9 and 10 are &quot;folded&quot; into bytes 1-8
using the following algorithm: </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:5.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>Bit 0 is the
high-order bit (i.e. has value of '80'X). </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>Byte 1, bits 0
and 1 are replaced with byte 1, bits 0 and 1 Exclusive OR'ed with byte 9, bits
0 and 1. </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>Byte 2, bits 0
and 1 are replaced with byte 2, bits 0 and 1 Exclusive OR'ed with byte 9, bits
2 and 3. </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>Byte 3, bits 0
and 1 are replaced with byte 3, bits 0 and 1 Exclusive OR'ed with byte 9, bits
4 and 5. </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>Byte 4, bits 0
and 1 are replaced with byte 4, bits 0 and 1 Exclusive OR'ed with byte 9, bits
6 and 7. </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>Byte 5, bits 0
and 1 are replaced with byte 5, bits 0 and 1 Exclusive OR'ed with byte 10, bits
0 and 1. </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>Byte 6, bits 0
and 1 are replaced with byte 6, bits 0 and 1 Exclusive OR'ed with byte 10, bits
2 and 3. </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>Byte 7, bits 0
and 1 are replaced with byte 7, bits 0 and 1 Exclusive OR'ed with byte 10, bits
4 and 5. </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>Byte 8, bits 0
and 1 are replaced with byte 8, bits 0 and 1 Exclusive OR'ed with byte 10, bits
6 and 7. </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:6.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>Handling
passwords of length 9 and 10:</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>1. Generate </span><span
lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>PW_TOKENa</span><span
lang=EN-US> by using characters 1 to 8 of the password and steps 1-4 from the
previous section. </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>2. Generate </span><span
lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>PW_TOKENb</span><span
lang=EN-US> by using characters 9 and 10 and steps 1-4 from the previous
section. In this case </span><span lang=EN-US style='font-size:8.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>Padded_PW</span><span
lang=EN-US> from step 1 will be characters 9 and 10 padded to the right with
'40'X, for a total length of 8. </span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Some additional steps having to do with
sequencing of transmission blocks have been omitted as not being applicable to
just computing the encrypted password itself. Note that if the password is less
than 9 characters long, only one 8-byte </span><span lang=EN-US
style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>PW_TOKEN
</span><span lang=EN-US>is computed and the remainder of the 16-byte encrypted
password is left blank. For longer passwords </span><span lang=EN-US
style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>PW_TOKENa
</span><span lang=EN-US>and </span><span lang=EN-US style='font-size:8.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>PW_TOKENb </span><span
lang=EN-US>are concatenated to form the final 16-byte encrypted password.</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The curious step of shifting the password
one bit to the left comes from the fact that just using the original password
as the key is actually not a good idea, because the DES algorithm does not use
the <i style='mso-bidi-font-style:normal'>low-order</i> bit of each character.
This is the infamous weakening of the algorithm from 64 bits to 56 bits as
demanded by the NSA for reasons never convincingly explained. Since DES does
not use the low-order bits, we would be throwing away information if we were
using the password <i style='mso-bidi-font-style:normal'>as-is</i>. Now,
because of the structure of the EBCDIC character set, one can actually omit the
<i style='mso-bidi-font-style:normal'>high-order</i> bit of every valid
password character without losing information. So, an obvious solution is
simply to shift the password to the left one bit. This preserves all
information and gives DES a low-order bit to throw away. </span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Let’s write MI-code to accomplish each
step:</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLAP<span style='mso-spacerun:yes'>     </span>KEY, PWD, X‘40’;<span
style='mso-spacerun:yes'>          </span><span style='color:green'>/* step 1
*/</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>  </span>XOR(S)<span style='mso-spacerun:yes'>     
</span>KEY, X‘5555555555555555’; <span style='color:green'>/* step 2 */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The “Exclusive Or”-instruction, </span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console";color:maroon'>XOR</span></b><span
lang=EN-US>, performs a bit-wise Boolean <i style='mso-bidi-font-style:normal'>exclusive
or</i> operation where two bits transform to a bit value of 1 if they are
different, otherwise to a bit value of 0.</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ADDLC(S)<span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>  </span>KEY, KEY;<span
style='mso-spacerun:yes'>                 </span><span style='color:green'>/*
step 3 */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The “Add Logical Character”-instruction, </span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console";color:maroon'>ADDLC</span></b><span
lang=EN-US>, is a convenient way of shifting a character string one bit to the
left (adding it to itself is the same as multiplying by two, which is the same
as shifting one bit to the left).</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Alternatively, we could have used the “Copy
Bits with Left Logical Shift”-instruction, </span><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Lucida Console";color:maroon'>CPYBTLLS</span></b><span lang=EN-US>,
which copies the bit string value of the <i style='mso-bidi-font-style:normal'>source</i>
operand to the bit string defined by the <i style='mso-bidi-font-style:normal'>receiver</i>
operand with a left logical shift of the source controlled by the value of the <i
style='mso-bidi-font-style:normal'>shift</i> (the 3<sup>rd</sup>) operand. The
shift operand must be an unsigned </span><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>BIN(2)</span><span
lang=EN-US> number, an unsigned immediate value, or a character </span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>CHAR(2)</span><span
lang=EN-US> value containing the shift count:</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:3.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>    </span>KEY, KEY, 1;<span
style='mso-spacerun:yes'>              </span><span style='color:green'>/* step
3, alternate */<o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Folding the excess characters of the user
name (if necessary) proceeds by shifting the characters into position,
extracting the topmost two bits (bit 0 and 1) and xor’ing them into the user
name:</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CMPBLA(B)<span style='mso-spacerun:yes'>   </span>USER(9:2), “<span
style='mso-spacerun:yes'>  </span>“/EQ(NEXT);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>    </span>WORK, USER(9:2),
0;<span style='mso-spacerun:yes'>       </span><span style='color:green'>/*
step 4, folding<span style='mso-spacerun:yes'>      </span>*/</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>AND(S)<span style='mso-spacerun:yes'>      </span>WORK, X‘C0’;<span
style='mso-spacerun:yes'>              </span><span style='color:green'>/*
extract bits 0 and 1 */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>      </span>USER(1:1), WORK;<span
style='mso-spacerun:yes'>          </span><span style='color:green'>/* XOR into
USER<span style='mso-spacerun:yes'>        </span>*/</span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>    </span>WORK, USER(9:2), 2;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>AND(S)<span style='mso-spacerun:yes'>      </span>WORK, X‘C0’;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>      </span>USER(2:1), WORK;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>    </span>WORK, USER(9:2), 4;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>AND(S)<span style='mso-spacerun:yes'>      </span>WORK, X‘C0’;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>      </span>USER(3:1), WORK;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>    </span>WORK, USER(9:2), 6;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>AND(S)<span style='mso-spacerun:yes'>      </span>WORK, X‘C0’;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>      </span>USER(4:1), WORK;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'> </span>WORK, USER(9:2), 8;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>AND(S)<span style='mso-spacerun:yes'>      </span>WORK, X‘C0’;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>      </span>USER(5:1), WORK;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>    </span>WORK, USER(9:2),
10;<span style='mso-spacerun:yes'>      </span><span style='color:green'>/*
note the numerical<span style='mso-spacerun:yes'>   </span>*/</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>AND(S)<span style='mso-spacerun:yes'>      </span>WORK, X‘C0’;<span
style='mso-spacerun:yes'>              </span><span style='color:green'>/*
relationship between */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>      </span>USER(6:1), WORK;<span
style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>        </span><span style='color:green'>/* the
various numbers: */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>    </span>WORK, USER(9:2), <b
style='mso-bidi-font-weight:normal'><span style='color:red'>12</span></b>;<span
style='mso-spacerun:yes'>      </span><span style='color:green'>/* </span><b
style='mso-bidi-font-weight:normal'><span style='color:red'>12</span></b><span
style='color:green'> = (</span><b style='mso-bidi-font-weight:normal'><span
style='color:blue'>7</span></b><span style='color:green'>-1)*2<span
style='mso-spacerun:yes'>  </span>*/</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>AND(S)<span style='mso-spacerun:yes'>      </span>WORK, X‘C0’;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>      </span>USER(<b
style='mso-bidi-font-weight:normal'><span style='color:blue'>7</span></b>:1),
WORK;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>    </span>WORK, USER(9:2), <b
style='mso-bidi-font-weight:normal'><span style='color:red'>14</span></b>;<span
style='mso-spacerun:yes'>      </span><span style='color:green'>/* </span><b
style='mso-bidi-font-weight:normal'><span style='color:red'>14</span></b><span
style='color:green'> = (</span><b style='mso-bidi-font-weight:normal'><span
style='color:blue'>8</span></b><span style='color:green'>-1)*2<span
style='mso-spacerun:yes'>  </span>*/</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>AND(S)<span style='mso-spacerun:yes'>      </span>WORK, X‘C0’;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>      </span>USER(<b
style='mso-bidi-font-weight:normal'><span style='color:blue'>8</span></b>:1),
WORK;<span style='mso-spacerun:yes'>          </span><span style='color:green'>/*
end of step 4 */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>These eight pieces of almost identical code
cry out for a loop, where the shift amount can be computed from the character
position:</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>       </span>N, 8;<span
style='mso-spacerun:yes'>                     </span><span style='color:green'>/*
start from the end */</span></span></p>

<p class=MsoPlainText><span lang=EN-US>FOLD:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN<span style='mso-spacerun:yes'>        </span>SHIFT, N ,1;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ADDN(S)<span style='mso-spacerun:yes'>     </span>SHIFT, SHIFT;<span
style='mso-spacerun:yes'>             </span><span style='color:green'>/* shift
amount = (N -1)*2 */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>    </span>WORK, USER(9:2),
SHIFT;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>AND(S)<span style='mso-spacerun:yes'>      </span>WORK, X’C0’;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>      </span>USER(N), WORK;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN(SB)<span style='mso-spacerun:yes'>    </span>N, 1/POS(FOLD);<span
style='mso-spacerun:yes'>    </span></span></p>

<h3 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level3 lfo2'><span
lang=EN-US>Using </span><span lang=EN-US style='font-family:"Lucida Console"'>CIPHER</span><span
lang=EN-US> to DES-Encrypt</span></h3>

<p class=MsoNormal><span lang=EN-US>The </span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>CIPHER</span><span
lang=EN-US>-instruction, we used in chapter 13 for calculating a hash value,
can also be used to execute the DES encryption algorithm. This is what </span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>CIPHER</span><span
lang=EN-US> was originally designed to do. Because of the silly U.S. laws
regarding encryption, </span><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>CIPHER</span><span
lang=EN-US> was deliberately crippled in the AS/400 to the point where about
the only thing it can be used for is encryption of passwords. <i
style='mso-bidi-font-style:normal'>E.g.</i> the maximum amount of data that can
be encrypted was reduced to 64 bytes, and no decryption is available. The
control block is slightly different for DES encryption than for the hash
calculation:</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD CONTROL CHAR(32);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD CTRL-FUNCTION CHAR(2) DEF(CONTROL) POS(1) INIT(X'<b
style='mso-bidi-font-weight:normal'><span style='color:blue'>0002</span></b>');<span
style='mso-spacerun:yes'>     </span><span style='color:green'>/* DES encrypt
*/</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD CTRL-SIZE<span style='mso-spacerun:yes'>      </span>BIN(2)
DEF(CONTROL) POS(3) INIT(8);<span style='mso-spacerun:yes'>     </span><span
style='color:green'>/* bytes to encrypt<span style='mso-spacerun:yes'> 
</span>*/</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD CTRL-OPTION<span style='mso-spacerun:yes'>   </span>CHAR(1)
DEF(CONTROL) POS(5) INIT(X'00'); <span style='color:green'>/* simple encryption
*/<o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD KEY<span style='mso-spacerun:yes'>           </span>CHAR(8)
DEF(CONTROL) POS(6);<span style='mso-spacerun:yes'>             </span><span
style='color:green'>/* encryption key<span style='mso-spacerun:yes'>   
</span>*/</span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .CRYPT INIT(CRYPT); DCL DD
CRYPT CHAR(16);<span style='mso-spacerun:yes'>  </span><span style='color:green'>/*
Encryption result */</span></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .USER<span
style='mso-spacerun:yes'>  </span>INIT(USER);<span style='mso-spacerun:yes'> 
</span>DCL DD USER<span style='mso-spacerun:yes'>  </span>CHAR(10);<span
style='mso-spacerun:yes'>  </span><span style='color:green'>/* USER name<span
style='mso-spacerun:yes'>         </span>*/</span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CIPHER<span style='mso-spacerun:yes'>     </span>.CRYPT, CONTROL, .USER;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The </span><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Lucida Console";color:maroon'>MIENCPWD</span></b><span lang=EN-US>
program pulls it all together. Note how we have two loops, using a <i
style='mso-bidi-font-style:normal'>sentinel</i> at the end of the password,
which we made 16+8 characters long internally:</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD EPWD CHAR(16); <span
style='color:green'>/* ENCRYPTED PASSWORD<span
style='mso-spacerun:yes'>             </span>*/<o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD PWD<span
style='mso-spacerun:yes'>  </span>CHAR(24); <span style='color:green'>/* GIVEN
PASSWORD TO 24 POSITIONS */</span></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD WORK CHAR(1);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD SHIFT BIN(2) UNSGND;</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD N<span
style='mso-spacerun:yes'>     </span>BIN(2);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD P<span
style='mso-spacerun:yes'>     </span>BIN(2);</span></p>

<p class=MsoPlainText></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD CONTROL CHAR(32);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD CTRL-FUNCTION CHAR(2) DEF(CONTROL) POS(1) INIT(X'0002');</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD CTRL-SIZE<span style='mso-spacerun:yes'>      </span>BIN(2)
DEF(CONTROL) POS(3) INIT(8);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD CTRL-OPTION<span style='mso-spacerun:yes'>   </span>CHAR(1)
DEF(CONTROL) POS(5) INIT(X'00');</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD KEY<span style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>      </span>CHAR(8) DEF(CONTROL) POS(6);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .USER<span
style='mso-spacerun:yes'>  </span>INIT(USER);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD<span
style='mso-spacerun:yes'>      </span>USER<span style='mso-spacerun:yes'> 
</span>CHAR(10);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .CRYPT INIT(CRYPT);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD<span
style='mso-spacerun:yes'>      </span>CRYPT CHAR(8);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>SET-USER-PWD:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLAP<span style='mso-spacerun:yes'>     </span>USER, &quot;<b
style='mso-bidi-font-weight:normal'><span style='color:red'>LSVALGAARD</span></b>&quot;,
&quot; &quot;;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLAP<span style='mso-spacerun:yes'>     </span>PWD , &quot;<b
style='mso-bidi-font-weight:normal'><span style='color:blue'>LSVALGAARD</span></b>&quot;,
&quot; &quot;; <span style='color:green'>/* also clears sentinel */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBREP<span style='mso-spacerun:yes'>     </span>EPWD, &quot;
&quot;;<span style='mso-spacerun:yes'>     </span><span style='color:green'>/*
CLEAR ENCRYPTED PASSWORD */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CMPBLA(B)<span style='mso-spacerun:yes'>   </span>USER(9:2), &quot;<span
style='mso-spacerun:yes'>  </span>&quot;/EQ(PREPARE-TO-ENCRYPT);</span></p>

<p class=MsoPlainText></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>       </span>N, 8;<span
style='mso-spacerun:yes'>          </span><span style='color:green'>/* START
FROM THE END */</span></span></p>

<p class=MsoPlainText><span lang=EN-US>FOLD:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN<span style='mso-spacerun:yes'>        </span>SHIFT, N ,1;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ADDN(S)<span style='mso-spacerun:yes'>     </span>SHIFT, SHIFT;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>    </span>WORK, USER(9:2),
SHIFT;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>AND(S)<span style='mso-spacerun:yes'>      </span>WORK, X'C0'; <span
style='color:green'>/* TOP TWO BITS */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>      </span>USER(N:1), WORK;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN(SB)<span style='mso-spacerun:yes'>    </span>N, 1/POS(FOLD);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>PREPARE-TO-ENCRYPT:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>       </span>P, 1;</span></p>

<p class=MsoPlainText><span lang=EN-US>ENCRYPT:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLAP<span style='mso-spacerun:yes'>     </span>KEY, PWD(P:8),
X'40';<span style='mso-spacerun:yes'>        </span><span style='color:green'>/*
STEP 1 */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CMPBLA(B)<span style='mso-spacerun:yes'>   </span>KEY, X'40'/EQ(SHOW); <span
style='color:green'>/* compares 1<sup>st</sup> character only */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>      </span>KEY,
X'5555555555555555';<span style='mso-spacerun:yes'>    </span><span
style='color:green'>/* STEP 2 */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ADDLC(S)<span style='mso-spacerun:yes'>    </span>KEY, KEY;<span
style='mso-spacerun:yes'>                    </span><span style='color:green'>/*
STEP 3 */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CIPHER<span style='mso-spacerun:yes'>     </span>.CRYPT, CONTROL, .USER;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>      </span>EPWD(P:8), CRYPT;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ADDN(SB)<span style='mso-spacerun:yes'>    </span>P, 8/POS(ENCRYPT);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>SHOW:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CVTHC<span style='mso-spacerun:yes'>       </span>MSG-TEXT(1:32), EPWD;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CALLI<span style='mso-spacerun:yes'>       </span>SHOW-MESSAGE, *,
.SHOW-MESSAGE;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>RTX<span style='mso-spacerun:yes'>         </span>*;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>%INCLUDE SHOWMSG</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The result is precisely the first encrypted
password that we retrieved from the user table:</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>Type reply (if required), press
Enter.<span style='mso-spacerun:yes'>                                   </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'> 
</span>From<span style='mso-spacerun:yes'>  </span>. . . :<span
style='mso-spacerun:yes'>   </span>LSVALGAARD<span
style='mso-spacerun:yes'>     </span>10/01/00<span style='mso-spacerun:yes'>  
</span>19:16:21<span style='mso-spacerun:yes'>                     </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'> 
</span>1C26CBC1C4910CFCD71BC19F694F7FEF­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­ </span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>Algorithm for the 2<sup>nd</sup> Encrypted Password</span></h2>

<p class=MsoNormal><span lang=EN-US>In order that people should be able to
logon to the AS/400 directly from Windows, the AS/400 also supports the LANMAN
password encryption by storing the LANMAN encrypted password as the 2<sup>nd</sup>
encrypted value in the user table. The algorithm for computing the LANMAN
encrypted password has been all over the Internet for several years. A C++
implementation can be downloaded from:</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'>  </span><a
href="http://download.sourceforge.net/mirrors/NetBSD/NetBSD-current/pkgsrc/net/ppp-mppe/patches/patch-bj">http://download.sourceforge.net/mirrors/NetBSD/NetBSD-current/pkgsrc/net/ppp-mppe/patches/patch-bj</a>
</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>LANMAN is Microsoft’s Manager for Local
Area Networks. There are some fascinating stories out there about LANMAN
security. One of the better references is <a
href="http://www.l0pht.com/l0phtcrack/rant.html">http://www.l0pht.com/l0phtcrack/rant.html</a>.
We quote: </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>I didn't ask to
be cc'd into the rantings of the MS Borg Marketing Juggernaut but since I'm
here... I find this hilarious. The people at MS should know better. I haven't
been following this thread tremendously but I've seen bits and pieces. Recently
there was an atrocious article in WindowsNT magazine, where they stated it
would take 5000 or so years to break the passwords; thus put policy in place to
have users change their passwords every 2500 years. HELLO? I think these people
aren't getting it. Let's shed some light on things shall we? </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:5.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>1. Thank you
very little MS for dropping any reference to the l0pht, hobbit, or myself in
reference to your recent LM-Hash fix. If this is how you &quot;correspond&quot;
with people who point out problems to you it's no wonder that people prefer to
release things to the public instead of your &quot;proper&quot; channels. </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:5.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>2. MS agrees
that the LM hash is a horrible implementation from a security standpoint. They
respond with “well we didn't write the protocol that was IBM”. [My comment: IBM
blames MS] </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:5.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>3. When MS had
the chance to do things a different way (<i style='mso-bidi-font-style:normal'>i.e.</i>
Network challenge/response obfuscation on NT boxes) they implemented it based
upon LM techniques to break up components.<span style='mso-spacerun:yes'> 
</span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:5.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>5. MS can’t
swallow their pride enough to say &quot;oops&quot;, even in technical circles
where they don't have to worry about the general public misinterpreting things.
</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:5.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>6. For the LM
hash you only have to break 7 characters, not 14! </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:5.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>7. MS keeps
talking about the NT hash being so secure while refusing to talk about how weak
the LM hash is. Guess what, you probably won't be able to use the &quot;added
security&quot; of the NT hash on your network. Why keep talking about something
people can't use? </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:5.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>9. […] Now,
let's rip apart why it is so trivial to go through the LM hash on the network.
[…] We already know that you only have to go through 7 characters to retrieve
passwords (up to 14 chars in length) in the LM hash, and that since there is no
salting being done, constants show up all over the place giving away too much
information and speeding up attacks tremendously. </span><span lang=EN-US
style='font-family:Courier'><span style='mso-spacerun:yes'> </span></span><span
lang=EN-US>The 1<sup>st</sup> 8 bytes are derived from the first seven
characters of the password and the 2<sup>nd</sup> 8 bytes are derived from the
8<sup>th</sup> through 14<sup>th</sup> characters of the password. If the
password is less than 8 characters then the second half will always be: </span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>0xAAD3B435B51404EE.</span><span
lang=EN-US><span style='mso-spacerun:yes'>  </span>[…] The 7 byte strings are
str_to_key'd (if you will) into 8 byte odd parity DES keys. […] The LM hash is
incredibly weak and your more secure NT hash is brought down to the lowest
common denominator.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Interchange MS with IBM, NT with OS/400,
and the story rings just as true. What is particular interesting is that both
parties blame each other for the weakness of the algorithm.</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Here is an excerpt from “Virtual Interview
with Jeremy Allison and Andrew Tridgell” which you can find at <a
href="http://www2.linuxjournal.com/lj-issues/issue50/2900.html">http://www2.linuxjournal.com/lj-issues/issue50/2900.html</a>:</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><b style='mso-bidi-font-weight:
normal'><i style='mso-bidi-font-style:normal'><span lang=EN-US>John</span></i></b><i
style='mso-bidi-font-style:normal'><span lang=EN-US>: So the protocol is just
whatever they could get to work? <o:p></o:p></span></i></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:6.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US>Jeremy</span></b><span lang=EN-US>: Yeah, basically.
The protocol is really horrible. It sort of grew like a wart. You can tell by
looking at it. So, what happened was once we got the long file name support
working, the next thing we wanted to get working was encrypted password
support. We hated having to put plaintext passwords out. There was a “magic
constant” that Microsoft actually refused to give out to anybody. It’s used in
the DES encryption for the LanMan password support. They refused to give it to
us without an NDA (Non-Disclosure Agreement). We replied “We're not giving you
an NDA, because we're publishing source.”</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:5.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>There it sat for
a while until I went to a Microsoft NT conference up in Seattle and had a
conversation with a, uhh, sort of mentally challenged Microsoft person who was
basically saying “Why do you want to break open all our LanMan systems?”, and I
said “I don't, I want to interoperate with them,”' which I suppose to her was
the same thing. So, she put me in touch with a Microsoft programmer, Richard
Ward, who is in charge of some of their security stuff. I chatted with him, and
he couldn’t tell me what it was, but he said, if you forward me a message I’ll
put you in touch with somebody who knows more about it.</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US><span
style='mso-spacerun:yes'> </span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>Now what
happened - and this is really interesting - the programmer he put me in touch
with basically said, “Well, what do you need to know?” I thought, well, if I
ask him the question directly, I won’t get the answer. He’ll say,<span
style='mso-spacerun:yes'>  </span>“I can't tell you that.” So, I phrased the
question differently. The LanMan encryption is a two stage operation, and we
needed the middle bit. I phrased the question in such a way that we could work
backwards from what he told us. I asked, if we encrypt this password, what will
the second stage be? Once he told us, it was trivial to reverse it and out
popped the magic constant. And once I had the constant, I actually took a look
at a hexdump of the Microsoft redirector, and the magic constant is contained
in a field of zeros as plain as day. </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:5.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US>Andrew</span></b><span lang=EN-US>: It actually took
us a day or two to realize that the information he sent gave us what we needed.
Jeremy and I both realized it independently within a few hours of each other.
It was an unexpected bonus! </span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US
style='font-size:5.0pt;mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><b style='mso-bidi-font-weight:
normal'><i style='mso-bidi-font-style:normal'><span lang=EN-US>John</span></i></b><i
style='mso-bidi-font-style:normal'><span lang=EN-US>: So it was easy to see the
magic constant once you knew where to look? [Note: the magic constant is
KGS!@#$%.] <o:p></o:p></span></i></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>A simple way of finding the magic constant
is to use a known password as a key and <i style='mso-bidi-font-style:normal'>decrypt</i>
the encrypted value giving the plain text, i.e. the magic constant.</span></p>

<h3 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level3 lfo2'><span
lang=EN-US>Why Seven Characters Instead of Eight?</span></h3>

<p class=MsoNormal><span lang=EN-US>The first seven characters of the
10-character password go into constructing the first piece of the encrypted
password string. But why <i style='mso-bidi-font-style:normal'>seven</i>? The
key used in DES is 64 bits long (8 characters). However, of these, DES only
uses 56 bits, as the low-order bit of each character is ignored. In an
unconvincing attempt to hide the fact that DES was deliberately crippled by
reducing the key length from 64 bits to 56 bits, the low-order bit was called
“the parity bit”. Just dropping the low-order bit is undesirable as a leading </span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>B</span><span
lang=EN-US> (</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>X</span><span lang=EN-US> ‘</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>C2</span><span
lang=EN-US>’) would encrypt the same as a </span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>C</span><span
lang=EN-US> (</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>X</span><span lang=EN-US>‘</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>C3</span><span
lang=EN-US>’). To build the key without losing information we proceed as
follows:</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Treat the password as one long string of
bits. Take the first 7 bits and place them left-justified in the first
character position of a key work area. Then take the<i style='mso-bidi-font-style:
normal'> next</i> 7 bits of the password and place <i style='mso-bidi-font-style:
normal'>them</i> left-justified in the <i style='mso-bidi-font-style:normal'>second</i>
character position of the key work area, and so on, until all eight character
positions of the key work area have been filled (this is also when all seven
characters of the password have been used). The low-order bit of each key
character can be set to anything you like (or left <i style='mso-bidi-font-style:
normal'>as-is</i>) since it is not used by the DES algorithm anyway.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The following MI-instructions build the </span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>KEY</span><span lang=EN-US>:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>  </span>KEY(1:1), PWD,<span
style='mso-spacerun:yes'>  </span>0; <span style='color:green'>/* copy bits TO,
FROM, SHIFT */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>  </span>KEY(2:1), PWD,<span
style='mso-spacerun:yes'>  </span>7;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>  </span>KEY(3:1), PWD, 14;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>  </span>KEY(4:1), PWD, 21;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>  </span>KEY(5:1), PWD, 28; <span
style='color:green'>/*<span style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'> </span>SHIFT = (N-1)*7<span
style='mso-spacerun:yes'>       </span>*/</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>  </span>KEY(6:1), PWD, 35;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>  </span>KEY(7:1), PWD, 42;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>  </span>KEY(8:1), PWD, 48;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>A loop seems in order, so:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>       </span>N, 8;<span
style='mso-spacerun:yes'>          </span><span style='color:green'>/* START
FROM THE END */</span></span></p>

<p class=MsoPlainText><span lang=EN-US>BUILD:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN<span style='mso-spacerun:yes'>        </span>SHIFT, N ,1;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>MULT(S)<span style='mso-spacerun:yes'>     </span>SHIFT, 7;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>    </span>KEY(N:1), PWD, SHIFT;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN(SB)<span style='mso-spacerun:yes'>    </span>N, 1/POS(BUILD);</span></p>

<h3 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level3 lfo2'><span
lang=EN-US>The Magic Constant</span></h3>

<p class=MsoNormal><span lang=EN-US>The <i style='mso-bidi-font-style:normal'>Magic
Constant</i> “KGS!@#$%” is used as clear-text in a DES-encryption with the key
we’ve just built. The last five characters are what you get if you hold down
the shift key on your keyboard and press the keys marked 1, 2, 3, 4, and 5 on
the row above </span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>QWERTY</span><span lang=EN-US>, namely “</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>!@#$%</span><span
lang=EN-US>”. The first three characters are “</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>KGS</span><span
lang=EN-US>”, obviously somebody’s initials. In short, the secret clear-text to
encrypt with the password is the ASCII representation of<span
style='mso-spacerun:yes'>  </span>“</span><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>KGS!@#$%</span><span
lang=EN-US>” and the padding character is the null character (same in EBCDIC
and ASCII). We can translate from EBCDIC to ASCII the same way we did in
chapter 13:</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>                                                            
</span><span style='mso-spacerun:yes'>         </span></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD ASCII-TABLE CHAR(256);<span
style='mso-spacerun:yes'>                                         </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD *(16) CHAR(16) DEF(ASCII-TABLE) POS(1) INIT<span
style='mso-spacerun:yes'>                </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>(X'00000000000000000000000000000000', <span style='color:teal'>/* 00-0F
---------------- */</span><span style='color:green'><o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'00000000000000000000000000000000', <span style='color:green'>/* 10-1F
---------------- */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'00000000000000000000000000000000', <span style='color:green'>/* 20-2F
---------------- */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'00000000000000000000000000000000', <span style='color:green'>/* 30-3F
---------------- */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'<b style='mso-bidi-font-weight:normal'><i><span style='color:red'>00</span></i></b>00000000000000000000<span
style='color:maroon'>2E2C282B</span>00', <span style='color:green'>/* 40-4F <i><span
style='mso-spacerun:yes'> </span></i>----------</span><span style='color:maroon'>.&lt;(+</span><span
style='color:green'>- */</span> </span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span><span style='mso-spacerun:yes'> </span>X'<span style='color:maroon'>26</span>000000000000000000<span
style='color:maroon'>21242A293B</span>00', <span style='color:green'>/* 50-5F </span><span
style='color:maroon'>&amp;</span><span style='color:green'>---------</span><span
style='color:maroon'>!$*);</span><span style='color:green'>- */</span> </span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'<span style='color:maroon'>2D2F</span>000000000000000000<span
style='color:maroon'>2C255F3E3F</span>', <span style='color:green'>/* 60-6F </span><span
style='color:maroon'>-/</span><span style='color:green'>---------</span><span
style='color:maroon'>,%_&gt;?</span><span style='color:green'> */</span> </span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'00000000000000000000<span style='color:maroon'>3A2340273D22</span>', <span
style='color:green'>/* 70-7F ----------</span><span style='color:maroon'>:#@'=&quot;</span><span
style='color:green'> */</span> </span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'00<span style='color:maroon'>414243444546474849</span>000000000000', <span
style='color:green'>/* 80-8F -</span><span style='color:maroon'>abcdefghi</span><span
style='color:green'>------ */</span> </span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'00<span style='color:maroon'>4A4B4C4D4E4F505152</span>000000000000', <span
style='color:green'>/* 90-9F -</span><span style='color:maroon'>jklmnopqr</span><span
style='color:green'>------ */</span> </span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'0000<span style='color:maroon'>535455565758595A</span>000000000000', <span
style='color:green'>/* A0-AF --</span><span style='color:maroon'>stuvwxyz</span><span
style='color:green'>------ */</span> </span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'00000000000000000000000000000000', <span style='color:green'>/* B0-BF
---------------- */</span> </span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'00<span style='color:maroon'>414243444546474849</span>000000000000', <span
style='color:green'>/* C0-CF -</span><span style='color:maroon'>ABCDEFGHI</span><span
style='color:green'>------ */</span> </span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'00<span style='color:maroon'>4A4B4C4D4E4F505152</span>000000000000', <span
style='color:green'>/* D0-DF -</span><span style='color:maroon'>JKLMNOPQR</span><span
style='color:green'>------ */</span> </span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'0000<span style='color:maroon'>535455565758595A</span>000000000000', <span
style='color:green'>/* E0-EF --</span><span style='color:maroon'>STUVWXYZ</span><span
style='color:green'>------ */</span> </span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'<span style='color:maroon'>30313233343536373839</span>000000000000');<span
style='color:green'>/* F0-FF </span><span style='color:maroon'>0123456789</span><span
style='color:green'>------ */</span> </span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span><span style='color:green'>/* NOTE THAT 'BLANK' TRANSLATES TO '</span><b
style='mso-bidi-font-weight:normal'><span style='color:red'>00</span></b><span
style='color:green'>' */<span style='mso-spacerun:yes'>                       
</span><o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>                                                                      
</span></span></p>

<p class=MsoPlainText><span lang=EN-US>TRANSLATE:</span></p>

<p class=MsoPlainText style='mso-hyphenate:none'><span lang=EN-US><span
style='mso-spacerun:yes'>    </span>XLATEWT<span style='mso-spacerun:yes'>    
</span>USER, &quot;<i><span style='color:maroon'>KGS!@#$%</span></i>&quot;,
ASCII-TABLE;<span style='mso-spacerun:yes'>                 </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XLATEWT<span style='mso-spacerun:yes'>     </span>PWD ,<span
style='mso-spacerun:yes'>  </span>PWD<span style='mso-spacerun:yes'>     
</span>, ASCII-TABLE;<span style='mso-spacerun:yes'>                 </span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>       </span>N, 8;<span
style='mso-spacerun:yes'>          </span><span style='color:green'>/* START
FROM THE END */</span></span></p>

<p class=MsoPlainText><span lang=EN-US>BUILD:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN<span style='mso-spacerun:yes'>        </span>SHIFT, N ,1;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>MULT(S)<span style='mso-spacerun:yes'>     </span>SHIFT, 7;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>    </span>KEY(N:1), PWD, SHIFT;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN(SB)<span style='mso-spacerun:yes'>    </span>N, 1/POS(BUILD);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CIPHER<span style='mso-spacerun:yes'>     </span>.CRYPT, CONTROL,
.USER;<span style='mso-spacerun:yes'>      </span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Because we need to encipher both 7-byte
pieces of the password, we add an extra loop:</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>       </span>P, 1;<span
style='mso-spacerun:yes'>     </span><span style='color:green'>/* character
position in password<span style='mso-spacerun:yes'>           </span>*/</span> </span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>       </span>E, 1;<span
style='mso-spacerun:yes'>     </span><span style='color:green'>/* character
position in encrypted password */</span> </span></p>

<p class=MsoPlainText><span lang=EN-US>NEXT:<span
style='mso-spacerun:yes'>                     </span><span style='color:green'><span
style='mso-spacerun:yes'>                  </span></span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>       </span>N, 8;<span
style='mso-spacerun:yes'>     </span><span style='color:green'>/* character
position in DES key<span style='mso-spacerun:yes'>            </span>*/</span><span
style='mso-spacerun:yes'>                   </span></span></p>

<p class=MsoPlainText><span lang=EN-US>BUILD:<span
style='mso-spacerun:yes'>                                      </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN<span style='mso-spacerun:yes'>        </span>SHIFT, N ,1;<span
style='mso-spacerun:yes'>                </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>MULT(S)<span style='mso-spacerun:yes'>     </span>SHIFT, 7;<span
style='mso-spacerun:yes'>                   </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>    </span>KEY(N:1), PWD(P:8),
SHIFT;<span style='mso-spacerun:yes'>  </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN(SB)<span style='mso-spacerun:yes'>    </span>N, 1/POS(BUILD);<span
style='mso-spacerun:yes'>            </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CIPHER<span style='mso-spacerun:yes'>     </span>.CRYPT, CONTROL,
.USER;<span style='mso-spacerun:yes'>      </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>      </span>EPWD(E:8), CRYPT;<span
style='mso-spacerun:yes'>           </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>                                            </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ADDN(S)<span style='mso-spacerun:yes'>     </span>P, 7;<span
style='mso-spacerun:yes'>                       </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ADDN(S)<span style='mso-spacerun:yes'>     </span>E, 8;<span
style='mso-spacerun:yes'>                       </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CMPNV(B)<span style='mso-spacerun:yes'>    </span>P, 14/LO(NEXT);<span
style='mso-spacerun:yes'>   </span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The result matches the second encrypted
password:<span style='mso-spacerun:yes'>          </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'>                                            </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span
style='mso-spacerun:yes'> </span>Type reply (if required), press Enter.<span
style='mso-spacerun:yes'>                              </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>  
</span>From<span style='mso-spacerun:yes'>  </span>. . . :<span
style='mso-spacerun:yes'>   </span>LSVALGAARD<span
style='mso-spacerun:yes'>     </span>10/01/00<span style='mso-spacerun:yes'>  
</span>22:44:22<span style='mso-spacerun:yes'>                </span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>  
</span>1C26CBC1C4910CFCD71BC19F694F7FEF 3117672E0EC27808ADD5B1A41F2CB2C0 <b
style='mso-bidi-font-weight:normal'><i style='mso-bidi-font-style:normal'><o:p></o:p></i></b></span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>The Compleat </span><span lang=EN-US style='font-family:"Lucida Console";
color:maroon'>MIENCPWD</span><span lang=EN-US> Program</span></h2>

<p class=MsoNormal><span lang=EN-US>The program to calculate both encrypted
passwords is now ready:</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD EPWD CHAR(16); <span
style='color:green'>/* ENCRYPTED PASSWORD<span
style='mso-spacerun:yes'>             </span>*</span>/</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD PWD<span
style='mso-spacerun:yes'>  </span>CHAR(24); <span style='color:green'>/* GIVEN
PASSWORD TO 24 POSITIONS *</span>/</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD WORK CHAR(1);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD SHIFT BIN(2) UNSGND;</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD N<span
style='mso-spacerun:yes'>     </span>BIN(2);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD P<span
style='mso-spacerun:yes'>     </span>BIN(2);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD E<span
style='mso-spacerun:yes'>     </span>BIN(2);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD ASCII-TABLE CHAR(256);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD *(16) CHAR(16) DEF(ASCII-TABLE) POS(1) INIT</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>(X'00000000000000000000000000000000', <span style='color:green'>/* 00-0F
---------------- */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'00000000000000000000000000000000', <span style='color:green'>/* 10-1F
---------------- */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'00000000000000000000000000000000', <span style='color:green'>/* 20-2F
---------------- */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'00000000000000000000000000000000', <span style='color:green'>/* 30-3F
---------------- */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'<b style='mso-bidi-font-weight:normal'><span style='color:red'>00</span></b>000000000000000000002E2C282B00',
<span style='color:green'>/* 40-4F<span style='mso-spacerun:yes'> 
</span>----------.&lt;(+- */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'2600000000000000000021242A293B00', <span style='color:green'>/* 50-5F
&amp;---------!$*);- */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'2D2F0000000000000000002C255F3E3F', <span style='color:green'>/* 60-6F
-/---------,%_&gt;? */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'000000000000000000003A2340273D22', <span style='color:green'>/* 70-7F
----------:#@'=&quot; */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'00414243444546474849000000000000', <span style='color:green'>/* 80-8F
-ABCDEFGHI------ */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'004A4B4C4D4E4F505152000000000000', <span style='color:green'>/* 90-9F
-JKLMNOPQR------ */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'0000535455565758595A000000000000', <span style='color:green'>/* A0-AF
--STUVWXYZ------ */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'00000000000000000000000000000000', <span style='color:green'>/* B0-BF
---------------- */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'00414243444546474849000000000000', <span style='color:green'>/* C0-CF
-ABCDEFGHI------ */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'004A4B4C4D4E4F505152000000000000', <span style='color:green'>/* D0-DF
-JKLMNOPQR------ */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'0000535455565758595A000000000000', <span style='color:green'>/* E0-EF
--STUVWXYZ------ */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>X'30313233343536373839000000000000');<span style='color:green'>/* F0-FF
0123456789------ */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD CONTROL CHAR(32);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD CTRL-FUNCTION CHAR(2) DEF(CONTROL) POS(1) INIT(X'0002');</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD CTRL-SIZE<span style='mso-spacerun:yes'>      </span>BIN(2)
DEF(CONTROL) POS(3) INIT(8);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD CTRL-OPTION<span style='mso-spacerun:yes'>   </span>CHAR(1)
DEF(CONTROL) POS(5) INIT(X'00');</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD KEY<span style='mso-spacerun:yes'>           </span>CHAR(8)
DEF(CONTROL) POS(6);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .USER<span
style='mso-spacerun:yes'>  </span>INIT(USER);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD<span
style='mso-spacerun:yes'>      </span>USER<span style='mso-spacerun:yes'> 
</span>CHAR(10);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .CRYPT INIT(CRYPT);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD<span
style='mso-spacerun:yes'>      </span>CRYPT CHAR(8);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>SET-USER-PWD:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLAP<span style='mso-spacerun:yes'>     </span>USER,
&quot;LSVALGAARD&quot;, &quot; &quot;;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLAP<span style='mso-spacerun:yes'>     </span>PWD ,
&quot;LSVALGAARD&quot;, &quot; &quot;;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>FIRST-ENCRYPTED-PASSWORD:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBREP<span style='mso-spacerun:yes'>     </span>EPWD, &quot;
&quot;;<span style='mso-spacerun:yes'>     </span><span style='color:green'>/*
CLEAR ENCRYPTED PASSWORD */<o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>   </span>CMPBLA(B)<span style='mso-spacerun:yes'>  
</span>USER(9:2), &quot;<span style='mso-spacerun:yes'> 
</span>&quot;/EQ(PREPARE-TO-ENCRYPT);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>       </span>N, 8;<span
style='mso-spacerun:yes'>          </span><span style='color:green'>/* START
FROM THE END */</span></span></p>

<p class=MsoPlainText><span lang=EN-US>FOLD:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN<span style='mso-spacerun:yes'>        </span>SHIFT, N ,1;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ADDN(S)<span style='mso-spacerun:yes'>     </span>SHIFT, SHIFT;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>    </span>WORK, USER(9:2),
SHIFT;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>AND(S)<span style='mso-spacerun:yes'>      </span>WORK, X'C0'; <span
style='color:green'>/* TOP TWO BITS */<o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>      </span>USER(N:1), WORK;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN(SB)<span style='mso-spacerun:yes'>    </span>N, 1/POS(FOLD);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>PREPARE-TO-ENCRYPT:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>       </span>P, 1;</span></p>

<p class=MsoPlainText><span lang=EN-US>ENCRYPT:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLAP<span style='mso-spacerun:yes'>     </span>KEY, PWD(P:8),
X'40';<span style='mso-spacerun:yes'>        </span><span style='color:green'>/*
STEP 1 */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CMPBLA(B)<span style='mso-spacerun:yes'>   </span>KEY, X'40'/EQ(SHOW);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>      </span>KEY, X'5555555555555555';<span
style='mso-spacerun:yes'>    </span><span style='color:green'>/* STEP 2 */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ADDLC(S)<span style='mso-spacerun:yes'>    </span>KEY, KEY;<span
style='mso-spacerun:yes'>                    </span><span style='color:green'>/*
STEP 3 */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CIPHER<span style='mso-spacerun:yes'>     </span>.CRYPT, CONTROL, .USER;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>      </span>EPWD(P:8), CRYPT;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ADDN(SB)<span style='mso-spacerun:yes'>    </span>P, 8/POS(ENCRYPT);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>SHOW:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBREP<span style='mso-spacerun:yes'>     </span>MSG-TEXT, &quot;
&quot;;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CVTHC<span style='mso-spacerun:yes'>       </span>MSG-TEXT(1:32), EPWD; <span
style='color:green'>/* 1ST ENCRYPTED PASSWORD */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>SECOND-ENCRYPTED-PASSWORD:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XLATEWT<span style='mso-spacerun:yes'>     </span>USER,
&quot;KGS!@#$%&quot;, ASCII-TABLE;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XLATEWT<span style='mso-spacerun:yes'>     </span>PWD ,<span
style='mso-spacerun:yes'>  </span>PWD<span style='mso-spacerun:yes'>     
</span>, ASCII-TABLE;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>       </span>P, 1; <span
style='color:green'>/* CHARACTER POSITION IN PASSWORD<span
style='mso-spacerun:yes'>           </span>*/</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>       </span>E, 1; <span
style='color:green'>/* CHARACTER POSITION IN ENCRYPTED PASSWORD */</span></span></p>

<p class=MsoPlainText><span lang=EN-US>NEXT:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>       </span>N, 8; <span
style='color:green'>/* CHARACTER POSITION IN DES KEY<span
style='mso-spacerun:yes'>            </span>*/</span></span></p>

<p class=MsoPlainText><span lang=EN-US>BUILD:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN<span style='mso-spacerun:yes'>        </span>SHIFT, N ,1;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>MULT(S)<span style='mso-spacerun:yes'>     </span>SHIFT, 7;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>    </span>KEY(N:1), PWD(P:8),
SHIFT;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN(SB)<span style='mso-spacerun:yes'>    </span>N, 1/POS(BUILD);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CIPHER<span style='mso-spacerun:yes'>     </span>.CRYPT, CONTROL, .USER;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>      </span>EPWD(E:8), CRYPT;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ADDN(S)<span style='mso-spacerun:yes'>     </span>P, 7;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ADDN(S)<span style='mso-spacerun:yes'>     </span>E, 8;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CMPNV(B)<span style='mso-spacerun:yes'>    </span>P, 14/LO(NEXT);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CVTHC<span style='mso-spacerun:yes'>       </span>MSG-TEXT(34:32), EPWD;
<span style='color:green'>/* 2ND ENCRYPTED PASSWORD */<o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CALLI<span style='mso-spacerun:yes'>       </span>SHOW-MESSAGE, *, .SHOW-MESSAGE;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>RTX<span style='mso-spacerun:yes'>         </span>*;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>%INCLUDE SHOWMSG</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>I hope you appreciate how elegantly these
things can be written in MI. Try to look at some of C++ implementations. </span></p>

<p class=MsoNormal><span lang=EN-US><br>
You can now see why the OS/400 password encryption is so poor, treating each
part of the password independently weakens both encryption methods. For the
first method, passwords longer than eight characters are not more secure than
passwords eight characters long. For the second method, passwords longer than
seven characters are not more secure than passwords seven characters long. </span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>The Brute-Force Attack</span></h2>

<p class=MsoNormal><span lang=EN-US>Because only passwords up to seven
characters need be considered, the total number of possible passwords to try is
only </span><span lang=EN-US style='mso-fareast-language:EN-US;layout-grid-mode:
line'>30*(40<sup>0</sup>+40<sup>1</sup>+40<sup>2</sup>+40<sup>3</sup>+40<sup>4</sup>+40<sup>5</sup>+40<sup>6</sup>)
= 30*(40<sup>7</sup>-1)/(40-1) = 126,030,769,230</span><span lang=EN-US>. Although
this number 10 years ago looked forbidding, it is not so today. On a 700 MHz
Pentium III PC with MMX instructions it is possible to search more than
7,000,000 keys per second. At this speed, <i style='mso-bidi-font-style:normal'>any</i>
password can be cracked in less than six hours. NEWS/400 recently <a
href="http://www.as400network.com/resources/artarchive/index.cfm?fuseaction=viewarticle&amp;CO_ContentID=6102">publis<span
style='mso-bookmark:_Hlt495077468'>h</span>ed</a><![if !supportNestedAnchors]><a
name="_Hlt495077468"></a><![endif]> a reference to a program written by Svend
Olaf Mikkelsen. The program can be downloaded freely from his home page at <a
href="http://inet.uni2.dk/~svolaf">http://inet.u<span style='mso-bookmark:_Hlt495077032'>n</span>i2.<span
style='mso-bookmark:_Hlt495076978'>d</span>k<span style='mso-bookmark:_Hlt459112862'>/</span>~svolaf</a><![if !supportNestedAnchors]><a
name="_Hlt459112862"></a><a name="_Hlt495076978"></a><a name="_Hlt495077032"></a><![endif]>.
The program can be started with parameters to search a smaller slice of the
search space, e.g. passwords starting with A through F. In this way, a parallel
attack can be carried out using several PCs. With six PCs running in parallel,
the password of any user, including </span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>QSECOFR</span></b><span lang=EN-US>, can be cracked in less than
an hour, even if the password were carefully chosen to be difficult to guess
(such as ‘D@1X7W#’).</span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>Passwords Stored in the Clear!</span></h2>

<p class=MsoNormal><span lang=EN-US>Some people may say; “…but you need to have
special *SECADM authority to use the </span><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Lucida Console";color:maroon'>QSYRUPWD</span></b><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;color:maroon'> </span><span
lang=EN-US>and the</span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt'> </span><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>QSYRUPWD</span></b><span lang=EN-US> API’s and you need *ALLOBJ
authority to get near the </span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>QSYUPTBL</span></b><span lang=EN-US> object...”. But what does
the strength of the password encryption and the difficulty of accessing the
user table matter, if passwords were stored in the clear somewhere else on the
system? Incredibly, this was indeed the case. Many people have known for a
decade that there were flaws in OS/400’s treatment of passwords. A fundamental
rule when dealing with sensitive information is that all storage where this
resides be cleared immediately after use. This did not happen on the AS/400.
Not only in one place, but in <i style='mso-bidi-font-style:normal'>two</i>
places, was the <i style='mso-bidi-font-style:normal'>clear text</i> copy of
the password left intact. Only when this was widely publicized recently did IBM
take action and issued two PTFs to remedy the situation (the second PTF was
even defective). Although the OS/400 security team at IBM should be commended
on taking action in spite of being low on the totem pole when it comes to
allocation of resources, the whole story (weakened algorithms, reduced key
space, passwords in clear) is really inexcusable. It is clear that IBM (and
Microsoft) could benefit from some peer review. It is also clear that this is
not going to happen any time soon.</span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>A Password Checking Utility</span></h2>

<p class=MsoNormal><span lang=EN-US>We can put the techniques learnt in this
chapter to practical use. Let’s write a program to check if a given user
profile/password combination is valid. This is simply a matter of combining
code from the other programs in the present chapter. Call the resulting
program, </span><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>MICHKPWD</span></b><span lang=EN-US>, with three parameters, the
first one being the name of the user profile, the second being the password to
check, and the third is a return value: “Y” if the password is correct, and “N”
otherwise. Here is the program:</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .P1 PARM;</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD PARM-USER<span
style='mso-spacerun:yes'>     </span>CHAR(10) BAS(.P1);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .P2 PARM;</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD PARM-PASSWORD CHAR(10) BAS(.P2);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .P3 PARM;</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD PARM-RESULT<span
style='mso-spacerun:yes'>   </span>CHAR(1)<span style='mso-spacerun:yes'> 
</span>BAS(.P3); <span style='color:green'>/* Y = OK, N = NOT OK */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL OL PARMS(.P1, .P2, .P3) EXT PARM
MIN(3);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .RECEIVER INIT(RECEIVER);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD<span
style='mso-spacerun:yes'>      </span>RECEIVER CHAR(2000);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD<span style='mso-spacerun:yes'>  </span>RCV-BYTES-RETURNED<span
style='mso-spacerun:yes'>  </span>BIN(4) DEF(RECEIVER) POS( 1);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD<span style='mso-spacerun:yes'>  </span>RCV-BYTES-AVAILABLE BIN(4)
DEF(RECEIVER) POS( 5);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD<span style='mso-spacerun:yes'>  </span>RCV-USER-PROFILE<span
style='mso-spacerun:yes'>  </span>CHAR(10) DEF(RECEIVER) POS( 9);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD<span style='mso-spacerun:yes'>  </span>RCV-DATA<span
style='mso-spacerun:yes'>        </span>CHAR(1982) DEF(RECEIVER) POS(19);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>       
</span>DCL DD RCV-ENCRYPTED-PASSWORD CHAR(16) DEF(RCV-DATA) POS(2);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .LENGTH INIT(LENGTH);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD<span
style='mso-spacerun:yes'>      </span>LENGTH BIN(4)<span
style='mso-spacerun:yes'>  </span>INIT(2000);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .FORMAT INIT(FORMAT);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD<span
style='mso-spacerun:yes'>      </span>FORMAT CHAR(8)
INIT(&quot;UPWD0100&quot;);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .USER<span
style='mso-spacerun:yes'>   </span>INIT(USER);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD<span
style='mso-spacerun:yes'>      </span>USER<span style='mso-spacerun:yes'>  
</span>CHAR(10);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .ERROR<span
style='mso-spacerun:yes'>  </span>INIT(ERROR);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD<span
style='mso-spacerun:yes'>      </span>ERROR<span style='mso-spacerun:yes'> 
</span>BIN(4)<span style='mso-spacerun:yes'>  </span>INIT(0);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL OL QSYRUPWD (.RECEIVER, .LENGTH,
.FORMAT, .USER, .ERROR);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SYSPTR .SEPT(6440)
BAS(SEPT-POINTER);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPC PROCESS-COMMUNICATION-OBJECT
BASPCO;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL SPCPTR SEPT-POINTER DIR;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD EPWD CHAR(16); <span
style='color:green'>/* ENCRYPTED PASSWORD<span
style='mso-spacerun:yes'>             </span>*/<o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD PWD<span
style='mso-spacerun:yes'>  </span>CHAR(24); <span style='color:green'>/* GIVEN
PASSWORD TO 24 POSITIONS */</span></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD WORK CHAR(1);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD SHIFT BIN(2) UNSGND;</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD N<span
style='mso-spacerun:yes'>     </span>BIN(2);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD P<span
style='mso-spacerun:yes'>     </span>BIN(2);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD CONTROL CHAR(32);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD CTRL-FUNCTION CHAR(2) DEF(CONTROL) POS(1) INIT(X'0002');</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD CTRL-SIZE<span style='mso-spacerun:yes'>      </span>BIN(2)
DEF(CONTROL) POS(3) INIT(8);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD CTRL-OPTION<span style='mso-spacerun:yes'>   </span>CHAR(1)
DEF(CONTROL) POS(5) INIT(X'00');</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>DCL DD KEY<span style='mso-spacerun:yes'>           </span>CHAR(8)
DEF(CONTROL) POS(6);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>DCL SPCPTR .CRYPT INIT(CRYPT);</span></p>

<p class=MsoPlainText><span lang=EN-US>DCL DD<span
style='mso-spacerun:yes'>      </span>CRYPT CHAR(8);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='color:green'>/*******************************************************************/<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>ENTRY * (PARMS) EXT;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>    </span>PARM-RESULT, &quot;N&quot;; <span
style='color:green'>/* ASSUME BAD */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLAP<span style='mso-spacerun:yes'>      </span>PWD , PARM-PASSWORD,
&quot; &quot;;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>       </span>USER, PARM-USER;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CALLX<span style='mso-spacerun:yes'>       </span>.SEPT(5723), QSYRUPWD,
*;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBREP<span style='mso-spacerun:yes'>      </span>EPWD, &quot;
&quot;;<span style='mso-spacerun:yes'>     </span><span style='color:green'>/*
CLEAR ENCRYPTED PASSWORD */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CMPBLA(B)<span style='mso-spacerun:yes'>    </span>USER(9:2),
&quot;<span style='mso-spacerun:yes'>  </span>&quot;/EQ(PREPARE-TO-ENCRYPT);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>        </span>N, 8;<span
style='mso-spacerun:yes'>          </span><span style='color:green'>/* START
FROM THE END */<o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US>FOLD:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN<span style='mso-spacerun:yes'>         </span>SHIFT, N ,1;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ADDN(S)<span style='mso-spacerun:yes'>      </span>SHIFT, SHIFT;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBTLLS<span style='mso-spacerun:yes'>     </span>WORK, USER(9:2),
SHIFT;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>AND(S)<span style='mso-spacerun:yes'>       </span>WORK, X'C0'; <span
style='color:green'>/* TOP TWO BITS */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>       </span>USER(N:1), WORK;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>SUBN(SB)<span style='mso-spacerun:yes'>     </span>N, 1/POS(FOLD);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>PREPARE-TO-ENCRYPT:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>        </span>P, 1;</span></p>

<p class=MsoPlainText><span lang=EN-US>ENCRYPT:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLAP<span style='mso-spacerun:yes'>      </span>KEY, PWD(P:8),
X'40';<span style='mso-spacerun:yes'>        </span><span style='color:green'>/*
STEP 1 */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CMPBLA(B)<span style='mso-spacerun:yes'>    </span>KEY, X'40'/EQ(CHECK);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>       </span>KEY,
X'5555555555555555';<span style='mso-spacerun:yes'>    </span><span
style='color:green'>/* STEP 2 */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ADDLC(S)<span style='mso-spacerun:yes'>     </span>KEY, KEY;<span
style='mso-spacerun:yes'>                    </span><span style='color:green'>/*
STEP 3 */</span></span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CIPHER<span style='mso-spacerun:yes'>      </span>.CRYPT, CONTROL,
.USER;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>       </span>EPWD(P:8), CRYPT;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>ADDN(SB)<span style='mso-spacerun:yes'>     </span>P, 8/POS(ENCRYPT);</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US>CHECK:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CMPBLA(B)<span style='mso-spacerun:yes'>    </span>EPWD,
RCV-ENCRYPTED-PASSWORD/NEQ(=+2);</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>       </span>PARM-RESULT,
&quot;Y&quot;;:</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>BRK &quot;1&quot;;</span></p>

<p class=MsoPlainText><span lang=EN-US><span style='mso-spacerun:yes'>   
</span>RTX<span style='mso-spacerun:yes'>          </span>*;</span></p>

<p class=MsoPlainText><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>To run the program you must, of course,
have authority to retrieve the encrypted password.</span></p>

<b style='mso-bidi-font-weight:normal'><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Arial",sans-serif;
mso-fareast-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
mso-ansi-language:EN-US;mso-fareast-language:NL;mso-bidi-language:AR-SA'><br
clear=all style='page-break-before:always'>
</span></i></b>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>DMPSYSOBJ in V4R5 and Later</span></h2>

<p class=MsoNormal><span lang=EN-US>In a silly attempt to “plaster over” the
exposure described in this chapter, IBM has “doctored” the </span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console";color:maroon'>DMPSYSOBJ</span></b><span
lang=EN-US> command to show the encrypted passwords as blanks, that is to “lie”
about what is in the </span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>QSYUPTBL</span></b><span lang=EN-US> object. This, of course,
fools nobody. The data is still there, as SST (or the Memory Explorer developed
in chapter 26) will readily show.</span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>Real Security</span></h2>

<p class=MsoNormal><span lang=EN-US>We’ll close this chapter with these words
from Bruce Schneier (Preface to <a
href="http://www.counterpane.com/applied.html">Applied Cryptography</a>): </span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US>“If I take a
letter, lock it in a safe, hide the safe somewhere in New York, then tell you
to read the letter, that’s not security. That’s obscurity. On the other hand,
if I take a letter and lock it in a safe, and then give you the safe along with
the design specifications of the safe and a hundred identical safes with their
combinations so that you and the world’s best safecrackers can study the
locking mechanism - and you still can’t open the safe and read the letter -
that’s security.”</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:10.8pt;margin-bottom:
0cm;margin-left:10.8pt;margin-bottom:.0001pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

</div>

</body>

</html>

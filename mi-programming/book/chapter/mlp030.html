<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="mlp030_files/filelist.xml">
<title>The Advanced Encryption Standard</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Leif Svalgaard</o:Author>
  <o:LastAuthor>BOS Theo</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>1244</o:TotalTime>
  <o:LastPrinted>2001-04-21T08:42:00Z</o:LastPrinted>
  <o:Created>2021-07-07T08:01:00Z</o:Created>
  <o:LastSaved>2021-07-07T08:01:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>5973</o:Words>
  <o:Characters>32854</o:Characters>
  <o:Company>Dell Computer Corporation</o:Company>
  <o:Lines>273</o:Lines>
  <o:Paragraphs>77</o:Paragraphs>
  <o:CharactersWithSpaces>38750</o:CharactersWithSpaces>
  <o:Version>16.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=themeData href="mlp030_files/themedata.thmx">
<link rel=colorSchemeMapping href="mlp030_files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:GrammarState>Clean</w:GrammarState>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>NL</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
   <w:UseWord97LineBreakingRules/>
   <w:SelectEntireFieldWithStartOrEnd/>
   <w:UseWord2002TableStyleRules/>
   <w:UseWord2010TableStyleRules/>
   <w:DontUseIndentAsNumberingTabStop/>
   <w:FELineBreak11/>
   <w:WW11IndentRules/>
   <w:DontAutofitConstrainedTables/>
   <w:AutofitLikeWW11/>
   <w:UnderlineTabInNumList/>
   <w:HangulWidthLikeWW11/>
   <w:UseNormalStyleForList/>
   <w:DontVertAlignCellWithSp/>
   <w:DontBreakConstrainedForcedTables/>
   <w:DontVertAlignInTxbx/>
   <w:Word11KerningPairs/>
   <w:CachedColBalance/>
  </w:Compatibility>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="false"
  DefSemiHidden="false" DefQFormat="false" DefPriority="99"
  LatentStyleCount="376">
  <w:LsdException Locked="false" Priority="0" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 9"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="header"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footer"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index heading"/>
  <w:LsdException Locked="false" Priority="35" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of figures"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope return"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="line number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="page number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of authorities"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="macro"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="toa heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 5"/>
  <w:LsdException Locked="false" Priority="10" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Closing"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Signature"/>
  <w:LsdException Locked="false" Priority="0" SemiHidden="true"
   UnhideWhenUsed="true" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Message Header"/>
  <w:LsdException Locked="false" Priority="11" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Salutation"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Date"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Note Heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Block Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="FollowedHyperlink"/>
  <w:LsdException Locked="false" Priority="22" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Document Map"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Plain Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="E-mail Signature"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Top of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Bottom of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal (Web)"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Acronym"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Cite"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Code"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Definition"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Keyboard"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Preformatted"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Sample"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Typewriter"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Variable"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Table"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation subject"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="No List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Contemporary"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Elegant"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Professional"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Balloon Text"/>
  <w:LsdException Locked="false" Priority="39" Name="Table Grid"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Theme"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" QFormat="true"
   Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" QFormat="true"
   Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" QFormat="true"
   Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" QFormat="true"
   Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" QFormat="true"
   Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" QFormat="true"
   Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" SemiHidden="true"
   UnhideWhenUsed="true" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="TOC Heading"/>
  <w:LsdException Locked="false" Priority="41" Name="Plain Table 1"/>
  <w:LsdException Locked="false" Priority="42" Name="Plain Table 2"/>
  <w:LsdException Locked="false" Priority="43" Name="Plain Table 3"/>
  <w:LsdException Locked="false" Priority="44" Name="Plain Table 4"/>
  <w:LsdException Locked="false" Priority="45" Name="Plain Table 5"/>
  <w:LsdException Locked="false" Priority="40" Name="Grid Table Light"/>
  <w:LsdException Locked="false" Priority="46" Name="Grid Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="Grid Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="Grid Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="46" Name="List Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="List Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="List Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Mention"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Smart Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hashtag"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Unresolved Mention"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Smart Link"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-2147482993 6144 0 0 31 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:EN-US;}
h1
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:center;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	mso-list:l1 level1 lfo2;
	tab-stops:14.4pt;
	font-size:14.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:14.0pt;
	mso-ansi-language:EN-US;
	mso-bidi-font-weight:normal;}
h2
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	mso-list:l1 level2 lfo2;
	tab-stops:14.4pt;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
h3
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	mso-list:l1 level3 lfo2;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;
	font-weight:normal;}
h4
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	mso-list:l1 level4 lfo2;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;
	mso-bidi-font-weight:normal;}
h5
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:5;
	mso-list:l1 level5 lfo2;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman",serif;
	mso-ansi-language:EN-US;
	font-weight:normal;}
h6
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:6;
	mso-list:l1 level6 lfo2;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman",serif;
	mso-ansi-language:EN-US;
	font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:7;
	mso-list:l1 level7 lfo2;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:8;
	mso-list:l1 level8 lfo2;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	text-indent:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:9;
	mso-list:l1 level9 lfo2;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial",sans-serif;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;
	font-weight:bold;
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-noshow:yes;
	mso-style-unhide:no;
	margin:0cm;
	text-align:justify;
	mso-pagination:widow-orphan;
	tab-stops:center 216.0pt right 432.0pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:EN-US;}
p.MsoListBullet, li.MsoListBullet, div.MsoListBullet
	{mso-style-update:auto;
	mso-style-noshow:yes;
	mso-style-unhide:no;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:18.0pt;
	text-align:justify;
	text-indent:-18.0pt;
	mso-pagination:widow-orphan;
	mso-list:l0 level1 lfo1;
	tab-stops:list 18.0pt;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:EN-US;}
a:link, span.MsoHyperlink
	{mso-style-noshow:yes;
	mso-style-unhide:no;
	color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-noshow:yes;
	mso-style-unhide:no;
	color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{mso-style-noshow:yes;
	mso-style-unhide:no;
	margin:0cm;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-ansi-language:EN-US;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;}
 /* Page Definitions */
 @page
	{mso-footnote-separator:url("mlp030_files/header.html") fs;
	mso-footnote-continuation-separator:url("mlp030_files/header.html") fcs;
	mso-endnote-separator:url("mlp030_files/header.html") es;
	mso-endnote-continuation-separator:url("mlp030_files/header.html") ecs;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:50.4pt;
	mso-page-numbers-chapter-style:header-1;
	mso-even-footer:url("mlp030_files/header.html") ef1;
	mso-footer:url("mlp030_files/header.html") f1;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 @list l0
	{mso-list-id:-119;
	mso-list-type:simple;
	mso-list-template-ids:-555848138;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-style-link:"List Bullet";
	mso-level-text:\F0B7;
	mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l1
	{mso-list-id:863635276;
	mso-list-template-ids:2136226370;}
@list l1:level1
	{mso-level-start-at:30;
	mso-level-style-link:"Heading 1";
	mso-level-suffix:space;
	mso-level-text:"Chapter %1";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level2
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 2";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level3
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 3";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level4
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 4";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level5
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 5";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level6
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 6";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level7
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 7";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level8
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 8";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
@list l1:level9
	{mso-level-number-format:none;
	mso-level-style-link:"Heading 9";
	mso-level-suffix:none;
	mso-level-text:"";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0cm;
	text-indent:0cm;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=NL link=blue vlink=purple style='tab-interval:36.0pt;word-wrap:break-word'>

<div class=WordSection1>

<h1 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level1 lfo2'><![if !supportLists]><span
lang=EN-US style='mso-fareast-font-family:Arial;mso-bidi-font-family:Arial'><span
style='mso-list:Ignore'>Chapter 30 </span></span><![endif]><span lang=EN-US><br>
</span><span lang=EN-US style='font-size:10.0pt'><br>
</span><span lang=EN-US>The Advanced Encryption Standard</span></h1>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>The Need for a New Encryption Standard</span></h2>

<p class=MsoNormal><span lang=EN-US>When the DES encryption standard was
adopted in 1977 it was stipulated that it be reviewed every five years. By 1987
it was already apparent that a replacement for DES was needed. It nevertheless
took another fourteen years before a replacement was adopted (actually, final
adoption is still pending at the time (2001) of writing). The then approving
body, the National Bureau of Standards (NBS, now the National Institute of
Standards and Technology, NIST) requested the National Security Agency’s (NSA)
help in evaluating the DES algorithm submitted by IBM. The NSA succeeded in
weakening the key length from 128 bits to 56 bits. The NBS published this NSA
modified DES algorithm. This was very likely the result of a mis-understanding
between the NSA and the NBS. The NSA thought that DES was to be hardware only.
The NSA has later said that DES was one of its greatest mistakes. Had they
known that the details would be released to the public, they would never have
agreed to it. Luckily, the mood has changed in the intervening years with most
people agreeing that security by obscurity is not the way to go.</span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>The New Encryption Standard</span></h2>

<p class=MsoNormal><span lang=EN-US>In 1997 NIST invited the public to submit
proposals for a new (“Advanced”) encryption standard (AES). </span><span
lang=EN-US style='mso-fareast-language:EN-US;layout-grid-mode:line'>In 1998,
NIST announced the acceptance of fifteen candidate algorithms and requested the
assistance of the cryptographic research community in analyzing these
candidates. The resulting analysis included an initial examination of the
security and efficiency characteristics for each algorithm. NIST reviewed the
results of this preliminary research and selected MARS, RC6™, Rijndael, Serpent
and Twofish as finalists. Having reviewed further public analysis of the
finalists, NIST has decided to propose <b style='mso-bidi-font-weight:normal'>Rijndael
</b>as the Advanced Encryption Standard (AES). The research results and
rationale for this selection are documented at this URL: <a
href="http://csrc.nist.gov/encryption/aes/round2/r2report.pdf"><span
style='mso-fareast-language:NL;layout-grid-mode:both'>http://csrc.nist.gov/encryption/aes/round2/r2report.pdf</span></a>.
The current status of the AES can be found at: <a
href="http://csrc.nist.gov/encryption/aes/rijndael/"><span style='mso-fareast-language:
NL;layout-grid-mode:both'>http://csrc.nist.gov/encryption<span
style='mso-bookmark:_Hlt511635094'>/</span>aes/rijndael/</span></a><![if !supportNestedAnchors]><a
name="_Hlt511635094"></a><![endif]>. The winning entry, <i style='mso-bidi-font-style:
normal'>Rijndael</i>, was submitted by two Belgian cryptographers: </span><span
lang=EN-US>Joan Daemon and Vincent Rijmen.</span><span lang=EN-US
style='mso-fareast-language:EN-US;layout-grid-mode:line'> For more information
about the authors, you can visit their home page at <a
href="http://www.esat.kuleuven.ac.be/~rijmen/rijndael/"><span style='mso-fareast-language:
NL;layout-grid-mode:both'>http://www.esat.kuleuven.ac.be/~rijmen/rijndael/</span></a>.
It seems significant that the winning entry is of non-US origin and is freely
available overseas (nevertheless, the standards document still talks about
export restrictions!). <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-fareast-language:EN-US;
layout-grid-mode:line'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-fareast-language:EN-US;
layout-grid-mode:line'>The Rijndael entry is of considerable simplicity and
mathematical elegance. It only uses “constant-time” operations like
table-lookup and exclusive or. The algorithm works on 16-byte blocks, with a
key length that can be varied from 128 bits to 256 bits. Only 128-bit keys will
be covered in our treatment of the AES.<o:p></o:p></span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US style='mso-fareast-language:EN-US;layout-grid-mode:line'>The Rounds <o:p></o:p></span></h2>

<p class=MsoNormal><span lang=EN-US>A cipher <i style='mso-bidi-font-style:
normal'>round</i>-function is performed repeatedly on the so-called <i
style='mso-bidi-font-style:normal'>internal state</i> of the algorithm. The
state (as the input and output block size) is 128 bits long and consists of
four 32-bit words. Initially, the input block is copied to the state; then the
round-function is performed on the state a certain number of times (10 times
for a 128-bit key), and finally, the resulting state is copied to the output
block.. From the key value a set of sub-keys is built, one for each round.
These sub-keys are referred to as a <i style='mso-bidi-font-style:normal'>key
schedule</i>. During a round, the input bytes are combined with bytes of the
key schedule through a mixture of substitution and carry-less addition
(exclusive or). Substitution is performed as table-lookup in a large <i
style='mso-bidi-font-style:normal'>S-box</i>. The S-box is simply a
“scrambler”, but is constructed carefully so that it has no “fixed-points”, <i
style='mso-bidi-font-style:normal'>i.e.</i> where S(<i style='mso-bidi-font-style:
normal'>a</i>) = <i style='mso-bidi-font-style:normal'>a</i>, as well as
several other desirable mathematical properties. The exact contents of the
S-box are not really important to the Rijndael algorithm. You can even
substitute the contents of the S-box with your own values if you fear that the
“official” version may contain hidden “trap-doors”. In addition to the S-box
there are also a number of permutations of the state and the input bytes. It is
possible to combine all these operations with the S-box to form one single (but
larger) “box”. The combined box is a large table. Using it improves performance
on machines that can process more than 8 bits in parallel (most machines
including the AS/400 fall in this category).</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>For performance reasons the state is
actually <i style='mso-bidi-font-style:normal'>two</i> times 128 bits long. In
the code that follows, the state is represented as eight 32-bit quantities: s0,
s1, s2, s3, and t0, t1, t2, t3. During one round s0, s1, s2, and s3 are used as
input values, while t0, t1, t2, and t3 are used as output values. In the next
round this is reversed. The code for a typical round looks like this (expressed
in C-like notation):</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>t0 = Te0[<b style='mso-bidi-font-weight:
normal'><span style='color:red'>s0</span></b>&gt;&gt;24] ^ Te1[(s1&gt;&gt;16)
&amp; 0xff] ^ Te2[(s2&gt;&gt; 8) &amp; 0xff] ^ Te3[s3 &amp; 0xff] ^ rk[4];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>t1 = Te0[s1&gt;&gt;24] ^
Te1[(s2&gt;&gt;16) &amp; 0xff] ^ Te2[(s3&gt;&gt; 8) &amp; 0xff] ^ Te3[<b
style='mso-bidi-font-weight:normal'><span style='color:red'>s0</span></b> &amp;
0xff] ^ rk[5];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>t2 = Te0[s2&gt;&gt;24] ^
Te1[(s3&gt;&gt;16) &amp; 0xff] ^ Te2[(<b style='mso-bidi-font-weight:normal'><span
style='color:red'>s0</span></b>&gt;&gt; 8) &amp; 0xff] ^ Te3[s1 &amp; 0xff] ^
rk[6];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>t3 = Te0[s3&gt;&gt;24] ^ Te1[(<b
style='mso-bidi-font-weight:normal'><span style='color:red'>s0</span></b>&gt;&gt;16)
&amp; 0xff] ^ Te2[(s1&gt;&gt; 8) &amp; 0xff] ^ Te3[s2 &amp; 0xff] ^ rk[7];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Let’s take one of these statements apart:</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:13.5pt;border-collapse:collapse;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext'>
 <tr style='mso-yfti-lastrow:yes'>
  <td width=210 style='width:157.5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
  10.0pt;font-family:"Lucida Console"'>t0 = Te0[s0&gt;&gt;24] <o:p></o:p></span></p>
  <p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
  10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  
  </span>^ Te1[(s1&gt;&gt;16) &amp; 0xff] <o:p></o:p></span></p>
  <p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
  10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  
  </span>^ Te2[(s2&gt;&gt; 8) &amp; 0xff] <o:p></o:p></span></p>
  <p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
  10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  
  </span>^ Te3[s3 &amp; 0xff] <o:p></o:p></span></p>
  <p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
  10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  
  </span>^ rk[4];<o:p></o:p></span></p>
  </td>
  <td width=312 valign=top style='width:234.0pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
  10.0pt'>Use first byte of s0 as subscript into Te0 and get that word,<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
  10.0pt'>XOR result with Te1 subscripted with second byte of s1,<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
  10.0pt'>XOR result with Te2 subscripted with third byte of s2,<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
  10.0pt'>XOR result with Te3 subscripted with last byte of s3,<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
  10.0pt'>XOR result with a key from the key schedule<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The tables Te0, Te1, etc, hold the combined
values of the permutation and S-box tables and look like this:</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD TE0(0:255) CHAR(4) BDRY(8) INIT(<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>X'<b style='mso-bidi-font-weight:normal'><span style='color:red'>C6</span></b>6363A5',
X'<b style='mso-bidi-font-weight:normal'><span style='color:red'>F8</span></b>7C7C84',
X'<b style='mso-bidi-font-weight:normal'><span style='color:red'>EE</span></b>777799',
X'<b style='mso-bidi-font-weight:normal'><span style='color:red'>F6</span></b>7B7B8D',<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>X'FFF2F20D', X'D66B6BBD', X'DE6F6FB1', X'91C5C554',<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>. . . <o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD TE1(0:255) CHAR(4) BDRY(8) INIT(<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>X'A5<b style='mso-bidi-font-weight:normal'><span style='color:red'>C6</span></b>6363',
X'84<b style='mso-bidi-font-weight:normal'><span style='color:red'>F8</span></b>7C7C',
X'99<b style='mso-bidi-font-weight:normal'><span style='color:red'>EE</span></b>7777',
X'8D<b style='mso-bidi-font-weight:normal'><span style='color:red'>F6</span></b>7B7B',<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>X'0DFFF2F2', X'BDD66B6B', X'B1DE6F6F', X'5491C5C5',<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>. . . <o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD TE2(0:255) CHAR(4) BDRY(8) INIT(<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>X'63A5<b style='mso-bidi-font-weight:normal'><span style='color:red'>C6</span></b>63',
X'7C84<b style='mso-bidi-font-weight:normal'><span style='color:red'>F8</span></b>7C',
X'7799<b style='mso-bidi-font-weight:normal'><span style='color:red'>EE</span></b>77',
X'7B8D<b style='mso-bidi-font-weight:normal'><span style='color:red'>F6</span></b>7B',<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>X'F20DFFF2', X'6BBDD66B', X'6FB1DE6F', X'C55491C5',<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>. . . <o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD TE3(0:255) CHAR(4) BDRY(8) INIT(<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>   </span>X'6363A5<b style='mso-bidi-font-weight:normal'><span
style='color:red'>C6</span></b>', X'7C7C84<b style='mso-bidi-font-weight:normal'><span
style='color:red'>F8</span></b>', X'777799<b style='mso-bidi-font-weight:normal'><span
style='color:red'>EE</span></b>', X'7B7B8D<b style='mso-bidi-font-weight:normal'><span
style='color:red'>F6</span></b>',<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>X'F2F20DFF', X'6B6BBDD6', X'6F6FB1DE', X'C5C55491',<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Note that the other tables, Te1, etc, are
just the basic table Te0 with each entry rotated 8 bits progressively to the
right. Having the “rotate” be <i style='mso-bidi-font-style:normal'>pre-computed</i>
speeds processing.</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The whole algorithm is actually nothing but
a very long series of such manipulations. The result of each operation is
forming the input to the next. Because the ‘exclusive or’ operations are
associative, we may perform them in any order that is convenient. An
MI-implementation of the above code fragment would be: </span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>    </span><b
style='mso-bidi-font-weight:normal'><span style='color:maroon'>CPYBTL</span></b><span
style='mso-spacerun:yes'>       </span>B, S0,<span style='mso-spacerun:yes'> 
</span>0, 8;<span style='mso-spacerun:yes'>  </span>XOR<span
style='mso-spacerun:yes'>      </span>T0, TE0(B), RK( 4);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, S1,<span
style='mso-spacerun:yes'>  </span>8, 8;<span style='mso-spacerun:yes'> 
</span>XOR(S)<span style='mso-spacerun:yes'>   </span>T0, TE1(B);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, S2, 16, 8;<span
style='mso-spacerun:yes'>  </span>XOR(S)<span style='mso-spacerun:yes'>  
</span>T0, TE2(B);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, S3, 24, 8;<span
style='mso-spacerun:yes'>  </span>XOR(S)<span style='mso-spacerun:yes'>  
</span>T0, TE3(B);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US>where:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD S0 CHAR(4); DCL DD S1 CHAR(4); DCL
DD S2 CHAR(4); DCL DD S3 CHAR(4);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD T0 CHAR(4); DCL DD T1 CHAR(4); DCL
DD T2 CHAR(4); DCL DD T3 CHAR(4);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD B BIN(4) UNSGND;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD RK(0:43) CHAR(4) BDRY(8); <span
style='color:green'>/* the key schedule */</span><o:p></o:p></span></p>

<h3 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level3 lfo2'><span
lang=EN-US>Copy Bits Logical (</span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-family:"Lucida Console";color:maroon'>CPYBTL</span></b><span
lang=EN-US>)</span></h3>

<p class=MsoNormal><span lang=EN-US>The “Copy Bits Logical” operation, </span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console";color:maroon'>CPYBTL</span></b><span
lang=EN-US>, copies the unsigned bit string <i style='mso-bidi-font-style:normal'>source</i>
operand starting at the specified <i style='mso-bidi-font-style:normal'>offset</i>
for a specified <i style='mso-bidi-font-style:normal'>length</i> to the <i
style='mso-bidi-font-style:normal'>receiver</i>: </span><span lang=EN-US
style='font-size:6.0pt;mso-bidi-font-size:10.0pt'><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-tab-count:1'>       </span>CPYBTL<span
style='mso-tab-count:2'>       </span><i style='mso-bidi-font-style:normal'>Receiver</i>,
<i style='mso-bidi-font-style:normal'>Source</i>, <i style='mso-bidi-font-style:
normal'>Offset</i>, <i style='mso-bidi-font-style:normal'>Length</i><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The length of the receiver cannot exceed
four bytes and the length operand must be an immediate value between 1 and 32.
The selected bits are treated as an unsigned bit string and copied right
adjusted to the receiver and padded on the <i style='mso-bidi-font-style:normal'>left</i>
with binary zeroes. Just what we need to be able to extract single bytes from
the 32-bit state variables, to then be used as subscript values.</span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>Generated RISC Code for </span><span lang=EN-US style='font-style:
normal'>MI</span><span lang=EN-US>-Version</span></h2>

<p class=MsoNormal><span lang=EN-US>Let’s look at the generated code for the
following typical line:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, S2, 16, 8;<span
style='mso-spacerun:yes'>  </span>XOR(S)<span style='mso-spacerun:yes'>  
</span>T0, TE2(B);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The </span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>CPYBTL</span><span
lang=EN-US> instruction is very efficient, it basically just directly loads the
byte we want:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>001518 88AC004A<span
style='mso-spacerun:yes'>  </span>LBZ<span style='mso-spacerun:yes'>    
</span>05(12)<span style='mso-spacerun:yes'>      </span>74 [hÐ ¢]<span
style='mso-spacerun:yes'>   </span>; pick up third byte of S2<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>00151C 90AC0060<span
style='mso-spacerun:yes'>  </span>STW<span style='mso-spacerun:yes'>    
</span>05(12) <span style='mso-spacerun:yes'>     </span>96 [°Ð -]<span
style='mso-spacerun:yes'>   </span>; store it as word in variable B<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>No shifting, masking, or other extraction
is needed. Continuing:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>001520 380C0918<span
style='mso-spacerun:yes'>  </span>ADDI<span style='mso-spacerun:yes'>   
</span>00 12<span style='mso-spacerun:yes'>     </span>2328 [····]<span
style='mso-spacerun:yes'>   </span>; load address of TE2 table<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>001524 808C0060<span
style='mso-spacerun:yes'>  </span>LWZ<span style='mso-spacerun:yes'>    
</span>04(12)<span style='mso-spacerun:yes'>      </span>96 [Øð -]<span
style='mso-spacerun:yes'>   </span>; load B (<b style='mso-bidi-font-weight:
normal'><span style='color:red'>again</span></b>)<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The optimizer didn’t do a good job here as
there is no reason to reload B (it was already in a register).</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>001528 80AC0050<span
style='mso-spacerun:yes'>  </span>LWZ<span style='mso-spacerun:yes'>    
</span>05(12)<span style='mso-spacerun:yes'>      </span>80 [ØÐ &amp;]<span
style='mso-spacerun:yes'>   </span>; load T0<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>00152C 5484103A<span
style='mso-spacerun:yes'>  </span>RLWINM<span style='mso-spacerun:yes'> 
</span>04 04 02 00 29 [èd··]<span style='mso-spacerun:yes'>   </span>; multiply
B by 4 to index a word<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>001530 7C802214<span
style='mso-spacerun:yes'>  </span>ADD<span style='mso-spacerun:yes'>    
</span>04 00 04<span style='mso-spacerun:yes'>       </span>[@Ø··]<span
style='mso-spacerun:yes'>   </span>; add TE2 base address<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>001534 7FC40088<span
style='mso-spacerun:yes'>  </span>TD<span style='mso-spacerun:yes'>     
</span>30 04 00<span style='mso-spacerun:yes'>       </span>[&quot;D h]<span
style='mso-spacerun:yes'>   </span>; check subscript<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>001538 80040000<span
style='mso-spacerun:yes'>  </span>LWZ<span style='mso-spacerun:yes'>    
</span>00(04)<span style='mso-spacerun:yes'>       </span>0 [Ø·<span
style='mso-spacerun:yes'>  </span>]<span style='mso-spacerun:yes'>   </span>;
load TE2[B]<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>00153C 7C042A78<span
style='mso-spacerun:yes'>  </span>XOR<span style='mso-spacerun:yes'>    
</span>04 00 05<span style='mso-spacerun:yes'>       </span>[@··Ì]<span
style='mso-spacerun:yes'>   </span>; XOR with T0 already loaded<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>001540 908C0050<span
style='mso-spacerun:yes'>  </span>STW<span style='mso-spacerun:yes'>    
</span>04(12)<span style='mso-spacerun:yes'>      </span>80 [°ð &amp;]<span
style='mso-spacerun:yes'>   </span>; store T0<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Again, the optimizer doesn’t remove the
superfluous load and store of T0, plus the code insists on checking that the
subscript is valid. In total, that slows the process by at least a factor of
two. </span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>Generated RISC Code for </span><span lang=EN-US style='font-style:
normal'>C</span><span lang=EN-US>-Version</span></h2>

<p class=MsoNormal><span lang=EN-US>Since the AES code is available in <i
style='mso-bidi-font-style:normal'>C</i>, we can compile the <i
style='mso-bidi-font-style:normal'>C</i> code for:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>t0 = Te0[s0&gt;&gt;24] ^
Te1[(s1&gt;&gt;16) &amp; 0xff] ^ Te2[(s2&gt;&gt; 8) &amp; 0xff] ^ Te3[s3 &amp;
0xff] ^ rk[4];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Here is the generated code for this
fragment from the C-module:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005420 815FFFEC<span
style='mso-spacerun:yes'>  </span>LWZ<span style='mso-spacerun:yes'>    
</span>10(31)<span style='mso-spacerun:yes'>     </span>-20 [a¬·Ö] <o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005424 79460620<span
style='mso-spacerun:yes'>  </span>RLDICL<span style='mso-spacerun:yes'> 
</span>06 10 00 56<span style='mso-spacerun:yes'>    </span>[`ã··] s3 &amp;
0xff<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005428 78C81764<span
style='mso-spacerun:yes'>  </span>RLDICR<span style='mso-spacerun:yes'> 
</span>08 06 02 61<span style='mso-spacerun:yes'>    </span>[ÌH·À] <o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>00542C 79080020<span
style='mso-spacerun:yes'>  </span>RLDICL<span style='mso-spacerun:yes'> 
</span>08 08 00 32<span style='mso-spacerun:yes'>    </span>[`· ·] <o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005430 39240C30<span
style='mso-spacerun:yes'>  </span>ADDI<span style='mso-spacerun:yes'>   
</span>09 04<span style='mso-spacerun:yes'>     </span>3120 [····] <o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005434 7CA94214<span
style='mso-spacerun:yes'>  </span>ADD<span style='mso-spacerun:yes'>    
</span>05 09 08<span style='mso-spacerun:yes'>       </span>[@zâ·] <o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005438 7FC54888<span
style='mso-spacerun:yes'>  </span>TD<span style='mso-spacerun:yes'>     
</span>30 05 09<span style='mso-spacerun:yes'>       </span>[&quot;Eçh] <o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>00543C 81850000<span
style='mso-spacerun:yes'>  </span>LWZ<span style='mso-spacerun:yes'>    
</span>12(05)<span style='mso-spacerun:yes'>       </span>0 [ae<span
style='mso-spacerun:yes'>  </span>] Te3[] to R12<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005440 815FFFE8<span
style='mso-spacerun:yes'>  </span>LWZ<span style='mso-spacerun:yes'>    
</span>10(31)<span style='mso-spacerun:yes'>     </span>-24 [a¬·Y] <o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005444 5546C23E<span
style='mso-spacerun:yes'>  </span>RLWINM<span style='mso-spacerun:yes'> 
</span>06 10 24 08 31 [íãB·] (s2&gt;&gt; 8) &amp; 0xff<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005448 78C80620<span
style='mso-spacerun:yes'>  </span>RLDICL<span style='mso-spacerun:yes'> 
</span>08 06 00 56<span style='mso-spacerun:yes'>    </span>[ÌH··] <o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>00544C 79051764<span
style='mso-spacerun:yes'>  </span>RLDICR<span style='mso-spacerun:yes'> 
</span>05 08 02 61<span style='mso-spacerun:yes'>    </span>[`··À]<span
style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005450 78A50020<span
style='mso-spacerun:yes'>  </span>RLDICL<span style='mso-spacerun:yes'> 
</span>05 05 00 32<span style='mso-spacerun:yes'>    </span>[Ìv ·]<span
style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005454 39440830<span
style='mso-spacerun:yes'>  </span>ADDI<span style='mso-spacerun:yes'>   
</span>10 04<span style='mso-spacerun:yes'>     </span>2096 [·à··]<span
style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005458 7CCA2A14<span
style='mso-spacerun:yes'>  </span>ADD<span style='mso-spacerun:yes'>    
</span>06 10 05<span style='mso-spacerun:yes'>       </span>[@­··]<span
style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>00545C 7FC65088<span
style='mso-spacerun:yes'>  </span>TD<span style='mso-spacerun:yes'>     
</span>30 06 10<span style='mso-spacerun:yes'>      
</span>[&quot;F&amp;h]<span style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005460 81060000<span
style='mso-spacerun:yes'>  </span>LWZ<span style='mso-spacerun:yes'>    
</span>08(06)<span style='mso-spacerun:yes'>       </span>0 [a·<span
style='mso-spacerun:yes'>  </span>] Te2[] to R8<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005464 80BFFFE4<span
style='mso-spacerun:yes'>  </span>LWZ<span style='mso-spacerun:yes'>    
</span>05(31)<span style='mso-spacerun:yes'>     </span>-28 [Ø×·U]<span
style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005468 54A6843E<span
style='mso-spacerun:yes'>  </span>RLWINM<span style='mso-spacerun:yes'> 
</span>06 05 16 16 31 [èwd·] (s1&gt;&gt;16) &amp; 0xff <span
style='mso-spacerun:yes'>  </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>00546C 78C50620<span
style='mso-spacerun:yes'>  </span>RLDICL<span style='mso-spacerun:yes'> 
</span>05 06 00 56<span style='mso-spacerun:yes'>    </span>[ÌE··]<span
style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005470 78A61764<span
style='mso-spacerun:yes'>  </span>RLDICR<span style='mso-spacerun:yes'> 
</span>06 05 02 61<span style='mso-spacerun:yes'>    </span>[Ìw·À]<span
style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005474 78C60020<span
style='mso-spacerun:yes'>  </span>RLDICL<span style='mso-spacerun:yes'> 
</span>06 06 00 32<span style='mso-spacerun:yes'>    </span>[ÌF ·]<span
style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005478 38A40430<span
style='mso-spacerun:yes'>  </span>ADDI<span style='mso-spacerun:yes'>   
</span>05 04<span style='mso-spacerun:yes'>     </span>1072 [·u··]<span
style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>00547C 7FC53214<span
style='mso-spacerun:yes'>  </span>ADD<span style='mso-spacerun:yes'>    
</span>30 05 06<span style='mso-spacerun:yes'>       </span>[&quot;E··]<span
style='mso-spacerun:yes'>   </span><span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005480 7FDE2888<span
style='mso-spacerun:yes'>  </span>TD<span style='mso-spacerun:yes'>     
</span>30 30 05<span style='mso-spacerun:yes'>       </span>[&quot;ú·h]<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005484 80DE0000<span
style='mso-spacerun:yes'>  </span>LWZ<span style='mso-spacerun:yes'>    
</span>06(30)<span style='mso-spacerun:yes'>       </span>0 [Øú<span
style='mso-spacerun:yes'>  </span>] Te1[] to R6<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005488 83DFFFE0<span
style='mso-spacerun:yes'>  </span>LWZ<span style='mso-spacerun:yes'>    
</span>30(31)<span style='mso-spacerun:yes'>     </span>-32 [cÿ·\]<span
style='mso-spacerun:yes'>    </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>00548C 57DE463E<span
style='mso-spacerun:yes'>  </span>RLWINM<span style='mso-spacerun:yes'> 
</span>30 30 08 24 31 [ïúã·] (s0&gt;&gt;24) &amp; 0xff<span
style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005490 7BDE1764<span
style='mso-spacerun:yes'>  </span>RLDICR<span style='mso-spacerun:yes'> 
</span>30 30 02 61<span style='mso-spacerun:yes'>    </span>[#ú·À]<span
style='mso-spacerun:yes'>       </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005494 7BDE0020<span
style='mso-spacerun:yes'>  </span>RLDICL<span style='mso-spacerun:yes'> 
</span>30 30 00 32<span style='mso-spacerun:yes'>    </span>[#ú ·]<span
style='mso-spacerun:yes'>       </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>005498 3BA40030<span
style='mso-spacerun:yes'>  </span>ADDI<span style='mso-spacerun:yes'>   
</span>29 04<span style='mso-spacerun:yes'>       </span>48 [·u ·]<span
style='mso-spacerun:yes'>       </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>00549C 7F9DF214<span
style='mso-spacerun:yes'>  </span>ADD<span style='mso-spacerun:yes'>    
</span>28 29 30<span style='mso-spacerun:yes'>       </span>[&quot;¸2·]<span
style='mso-spacerun:yes'>       </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0054A0 7FDCE888<span
style='mso-spacerun:yes'>  </span>TD<span style='mso-spacerun:yes'>     
</span>30 28 29<span style='mso-spacerun:yes'>       </span>[&quot;üYh]<span
style='mso-spacerun:yes'>       </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0054A4 83DC0000<span
style='mso-spacerun:yes'>  </span>LWZ<span style='mso-spacerun:yes'>    
</span>30(28)<span style='mso-spacerun:yes'>       </span>0 [cü<span
style='mso-spacerun:yes'>  </span>] Te0[] to R30<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0054A8 7FC63278<span
style='mso-spacerun:yes'>  </span>XOR<span style='mso-spacerun:yes'>    
</span>06 30 06<span style='mso-spacerun:yes'>       </span>[&quot;F·Ì] R6 =
R30 xor R6<span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0054AC 7CC84278<span
style='mso-spacerun:yes'>  </span>XOR<span style='mso-spacerun:yes'>    
</span>08 06 08<span style='mso-spacerun:yes'>       </span>[@HâÌ] R8 = R8 xor
R6<span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0054B0 7D066278<span
style='mso-spacerun:yes'>  </span>XOR<span style='mso-spacerun:yes'>    
</span>06 08 12<span style='mso-spacerun:yes'>       </span>['·ÂÌ] R6 = R8 xor
R12<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0054B4 7CCC3A78<span
style='mso-spacerun:yes'>  </span>XOR<span style='mso-spacerun:yes'>    
</span>12 06 07<span style='mso-spacerun:yes'>       </span>[@ö·Ì] R12= R6 xor
rk[4]<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0054B8 919FFFF0<span
style='mso-spacerun:yes'>  </span>STW<span style='mso-spacerun:yes'>    
</span>12(31)<span style='mso-spacerun:yes'>     </span>-16 [j¤·0] t0 =
result<span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Although the operations are executed in a
different order than for the MI-code, the number of instructions per assignment
to a state variable is about the same (10 and 11). <i style='mso-bidi-font-style:
normal'>C</i> was actually designed to be good at this kind of bit-diddling and
predictably performs well.</span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>Optimized RISC Code for </span><span lang=EN-US style='font-style:
normal'>C</span><span lang=EN-US>-Version</span></h2>

<p class=MsoNormal><span lang=EN-US>The </span><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Lucida Console";color:maroon'>CHGPGM</span></b><span lang=EN-US>
command has an optimize option:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>===&gt; CHGPGM PGM(MYPGM) OPTIMIZE(<b
style='mso-bidi-font-weight:normal'><span style='color:red'>*FULL</span></b>)<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Setting the value to </span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>*FULL</span><span
lang=EN-US> invokes a very aggressive optimizer. Unfortunately, IBM has decided
not to make that optimizing level available for OPM-programs. Let’s see how
well it does on our <i style='mso-bidi-font-style:normal'>C</i>-program. The
optimizer works on a *PGM object, not on the *MODULE object, so we must first
bind the <i style='mso-bidi-font-style:normal'>C</i>-program.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The optimizer does an <i style='mso-bidi-font-style:
normal'>outstanding</i> job. Here is the result of decompiling the same line of
code as above (I have rearranged the lines to bring together things that belong
together):</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>00009C 571ED5BA<span
style='mso-spacerun:yes'>         </span><span
style='mso-spacerun:yes'> </span>RLWINM 30,24,26,22,29 <o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>000068 38872038<span
style='mso-spacerun:yes'>          </span>ADDI 4,7,8248<span
style='mso-spacerun:yes'>         </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0000A4 7F84F02E<span
style='mso-spacerun:yes'>          </span>LWZX 28,4,30<span
style='mso-spacerun:yes'>          </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0000B4 541B55BA<span
style='mso-spacerun:yes'>          </span>RLWINM 27,0,10,22,29<span
style='mso-spacerun:yes'>  </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>00004C 39071C38<span
style='mso-spacerun:yes'>          </span>ADDI 8,7,7224<span
style='mso-spacerun:yes'>         </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0000B8 7F48D82E<span
style='mso-spacerun:yes'>          </span>LWZX 26,8,27<span
style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>       </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0000BC 559995BA<span
style='mso-spacerun:yes'>         </span><span style='background:yellow;
mso-highlight:yellow'><span style='mso-spacerun:yes'> </span><b
style='mso-bidi-font-weight:normal'>RLWINM 25,12,18,22,29</b><span
style='color:yellow'>.</span></span>; (s2&gt;&gt;8) &amp; 0xff<span
style='background:yellow;mso-highlight:yellow'><o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>000044 38C71838<span
style='mso-spacerun:yes'>         </span><span style='background:yellow;
mso-highlight:yellow'><span style='mso-spacerun:yes'> </span><b
style='mso-bidi-font-weight:normal'>ADDI 6,7,6200<span style='color:yellow'><span
style='mso-spacerun:yes'>        </span></span></b><span style='color:yellow'>.</span></span>;
get base of Te2<span style='background:yellow;mso-highlight:yellow'><o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0000C0 7F26C82E<span
style='mso-spacerun:yes'>         </span><span style='background:yellow;
mso-highlight:yellow'><span style='mso-spacerun:yes'> </span><b
style='mso-bidi-font-weight:normal'>LWZX 25,6,25<span
style='mso-spacerun:yes'>         </span></b><span style='color:yellow'>.</span></span>;
Te2[]<span style='background:yellow;mso-highlight:yellow'><o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0000C4 7F5BCA78<span
style='mso-spacerun:yes'>         </span><span style='background:yellow;
mso-highlight:yellow'><span style='mso-spacerun:yes'> </span><b
style='mso-bidi-font-weight:normal'>XOR 27,26,25<span
style='mso-spacerun:yes'>         </span></b><span style='color:yellow'>.</span></span>;
XOR into t0<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0000C8 555A15BA<span
style='mso-spacerun:yes'>          </span>RLWINM 26,10,2,22,29<span
style='mso-spacerun:yes'>  </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>000074 38A72438<span
style='mso-spacerun:yes'>          </span>ADDI 5,7,9272<span
style='mso-spacerun:yes'>         </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0000CC 7F25D02E<span
style='mso-spacerun:yes'>          </span>LWZX 25,5,26<span
style='mso-spacerun:yes'>          </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0000D0 7F9EDA78<span
style='mso-spacerun:yes'>          </span>XOR 30,28,27<span
style='mso-spacerun:yes'>          </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0000D8 7F3CF278<span
style='mso-spacerun:yes'>          </span>XOR 28,25,30<span
style='mso-spacerun:yes'>          </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0000D4 83690010<span
style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>      </span>LWZ 27,0X10(9)<span
style='mso-spacerun:yes'>        </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0000DC 7F7EE278<span
style='mso-spacerun:yes'>          </span>XOR 30,27,28<span
style='mso-spacerun:yes'>          </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Only four instructions are needed to
extract the byte value, lookup its substitution value in the table, and then
XOR’ing the result into the state. It gets even better further down because the
table base addresses are already loaded into registers. We are now down to <i
style='mso-bidi-font-style:normal'>three</i> instructions per line. <i
style='mso-bidi-font-style:normal'>This cannot be improved upon</i>:</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>000050 570B95BA<span
style='mso-spacerun:yes'>          </span>RLWINM 11,24,18,22,29<span
style='mso-spacerun:yes'>   </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>000054 7F66582E<span
style='mso-spacerun:yes'>          </span>LWZX 27,6,11<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>000058 559C55BA<span
style='mso-spacerun:yes'>  </span><span style='mso-spacerun:yes'>       </span><b
style='mso-bidi-font-weight:normal'><span style='background:yellow;mso-highlight:
yellow'><span style='mso-spacerun:yes'> </span>RLWINM 28,12,10,22,29<span
style='color:yellow'>.</span></span></b>; (s2&gt;&gt;16) &amp; 0xff<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>00005C 7C88E02E<span
style='mso-spacerun:yes'>         </span><b style='mso-bidi-font-weight:normal'><span
style='background:yellow;mso-highlight:yellow'><span
style='mso-spacerun:yes'> </span>LWZX 4,8,28<span
style='mso-spacerun:yes'>          </span><span style='color:yellow'>.</span></span></b>;
Te1[]<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>000060 7C9ADA78<span
style='mso-spacerun:yes'>         </span><b style='mso-bidi-font-weight:normal'><span
style='background:yellow;mso-highlight:yellow'><span
style='mso-spacerun:yes'> </span>XOR 26,4,27<span
style='mso-spacerun:yes'>          </span><span style='color:yellow'>.</span></span></b>;
XOR into t1<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>000080 555CD5BA<span
style='mso-spacerun:yes'>          </span>RLWINM 28,10,26,22,29<span
style='mso-spacerun:yes'>   </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>000084 7F64E02E<span
style='mso-spacerun:yes'>          </span>LWZX 27,4,28<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>00008C 541E15BA<span
style='mso-spacerun:yes'>          </span>RLWINM 30,0,2,22,29<span
style='mso-spacerun:yes'>     </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>000090 7FA5F02E<span
style='mso-spacerun:yes'>          </span>LWZX 29,5,30<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>000094 7F7CD278<span
style='mso-spacerun:yes'>          </span>XOR 28,27,26<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>000098 83490014<span
style='mso-spacerun:yes'>          </span>LWZ 26,0X14(9)<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0000A0 7FBBE278<span
style='mso-spacerun:yes'>          </span>XOR 27,29,28<span
style='mso-spacerun:yes'>            </span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>0000A8 7F5DDA78<span
style='mso-spacerun:yes'>          </span>XOR 29,26,27<span
style='mso-spacerun:yes'>       </span><span
style='mso-spacerun:yes'>     </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The conclusion is that <i style='mso-bidi-font-style:
normal'>for this type of problem</i>, the combination of <i style='mso-bidi-font-style:
normal'>C</i> and <i style='mso-bidi-font-style:normal'>full</i> optimization
cannot be beat. We shall therefore present the full AES algorithm in <i
style='mso-bidi-font-style:normal'>C</i> as well (</span><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Lucida Console";color:maroon'>AES</span></b><span lang=EN-US>).
The MI-version is available as </span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>MIAES</span></b><span lang=EN-US>.</span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US style='font-style:normal'>C</span><span lang=EN-US>-Version of AES</span></h2>

<p class=MsoNormal><span lang=EN-US>A problem with the <i style='mso-bidi-font-style:
normal'>C</i>-code is that you have to express extraction of bytes as shifts
and logical </span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>AND</span><span lang=EN-US>s in a
roundabout way that partly obscures the simplicity of the manipulations. A good
test of the readability of a program is the <i style='mso-bidi-font-style:normal'>telephone</i>
test: can you read the code out loud over the telephone to someone having to
type it in at the other end? The official AES <i style='mso-bidi-font-style:
normal'>C</i>-code has a hard time passing that test. This phenomenon is
sometimes called “code clutter”. The standard solution to this problem is to
use the <i style='mso-bidi-font-style:normal'>C</i>-preprocessor to encapsulate
the ugly code. The preprocessor is often misused to create a private
“mini”-language or to make <i style='mso-bidi-font-style:normal'>C</i> look
like Pascal or worse. In recognition of this, the designers of Java
deliberately excluded a Java pre-processor from the language. But there are
cases where the pre-processor <i style='mso-bidi-font-style:normal'>can</i> be
used to make the program clearer, simply by making it shorter, and the AES
algorithm is one of them.</span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>Defining an Encryption Round</span></h2>

<p class=MsoNormal><span lang=EN-US>Starting from the calculation of the t0
part of the state:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>t0 = Te0[s0&gt;&gt;24] ^ Te1[(s1&gt;&gt;16)
&amp; 0xff] ^ Te2[(s2&gt;&gt; 8) &amp; 0xff] ^ Te3[s3 &amp; 0xff] ^ rk[4];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>We can “paraphrase” it as a specific case
of the following <i style='mso-bidi-font-style:normal'>template</i> or
definition:</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>#define <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>ROUND_E(r, out, in0, in1, in2, in3, key)</span></b><span
style='mso-spacerun:yes'>       </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:1.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span><b
style='mso-bidi-font-weight:normal'><span style='color:maroon'>out</span></b> =
Te0[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in0</span></b>
&gt;&gt; 24)<span style='mso-spacerun:yes'>       </span>] ^<span
style='mso-spacerun:yes'>                  </span><span
style='mso-spacerun:yes'>    </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>       
</span>Te1[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in1</span></b>
&gt;&gt; 16) &amp; 0xff] ^<span style='mso-spacerun:yes'>                     
</span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>       
</span>Te2[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in2</span></b>
&gt;&gt;<span style='mso-spacerun:yes'>  </span>8) &amp; 0xff] ^<span
style='mso-spacerun:yes'>                      </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>       
</span>Te3[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in3</span></b><span
style='mso-spacerun:yes'>      </span>) &amp; 0xff] ^ <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>key</span></b><span
style='mso-spacerun:yes'>                  </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>namely:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(<b style='mso-bidi-font-weight:normal'><span style='color:red'>1</span></b>,
t0, s0, s1, s2, s3, rk[ 4]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>You may ask: what does the “</span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console";color:maroon'>r</span></b><span
lang=EN-US>” do? The answer is: nothing, but it gives the reader a handy way of
keeping track of which round is being performed by using </span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>ROUND_E</span><span
lang=EN-US> successively with </span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>r</span></b><span lang=EN-US> being 1, 2, 3, …</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>With this abbreviated way of expressing
what goes into the state and what comes out, we can write the encryption
routine as shown below. First some preliminary notation: the text we are about
to encrypt is called the <i style='mso-bidi-font-style:normal'>plaintext</i> (</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>pt</span><span
lang=EN-US>), the result of the encryption is the <i style='mso-bidi-font-style:
normal'>ciphertext</i> (</span><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>ct</span><span
lang=EN-US>), the key schedule is stored in the <i style='mso-bidi-font-style:
normal'>round key</i> array (</span><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>rk</span><span
lang=EN-US>). A special routine (see below) is needed to expand the <i
style='mso-bidi-font-style:normal'>encryption key</i> into the key schedule.</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Here then is the code (you can easily see
the regularities in how the source bytes are shifted from sub-round to
sub-round - it takes four 32-bit operations to complete a 128-bit round):</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:1.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:1.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>void AES_Encrypt(const u32 rk[], const u32
pt[], u32 ct[]) {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>u32 s0, s1, s2, s3,<span style='mso-spacerun:yes'>  </span>t0, t1, t2,
t3;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>s0
= pt[0] ^ rk[0];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>s1
= pt[1] ^ rk[1];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>s2
= pt[2] ^ rk[2];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>s3
= pt[3] ^ rk[3];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(1, <b style='mso-bidi-font-weight:normal'><span
style='color:blue'>t0</span></b>, s0, s1, s2, <b style='mso-bidi-font-weight:
normal'><span style='color:gray'>s3</span></b>, rk[ 4]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(1, t1, s1, s2, <b style='mso-bidi-font-weight:normal'><span
style='color:gray'>s3</span></b>, s0, rk[ 5]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(1, t2, s2, <b style='mso-bidi-font-weight:normal'><span
style='color:gray'>s3</span></b>, s0, s1, rk[ 6]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(1, t3, <b style='mso-bidi-font-weight:normal'><span
style='color:gray'>s3</span></b>, s0, s1, s2, rk[ 7]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(2, s0, <b style='mso-bidi-font-weight:normal'><span
style='color:blue'>t0</span></b>, t1, t2, <b style='mso-bidi-font-weight:normal'><span
style='color:gray'>t3</span></b>, rk[ 8]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(2, s1, t1, t2, <b style='mso-bidi-font-weight:normal'><span
style='color:gray'>t3</span></b>, t0, rk[ 9]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(2, s2, t2, <b style='mso-bidi-font-weight:normal'><span
style='color:gray'>t3</span></b>, t0, t1, rk[10]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(2, s3, <b style='mso-bidi-font-weight:normal'><span
style='color:gray'>t3</span></b>, t0, t1, t2, rk[11]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>…<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(8, <b style='mso-bidi-font-weight:normal'><span
style='color:blue'>s0</span></b>, t0, t1, t2, t3, rk[32]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(8, s1, t1, t2, t3, t0, rk[33]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(8, s2, t2, t3, t0, t1, rk[34]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(8, s3, t3, t0, t1, t2, rk[35]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(9, t0, <b style='mso-bidi-font-weight:normal'><span
style='color:blue'>s0</span></b>, s1, s2, s3, rk[36]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(9, t1, s1, s2, s3, s0, rk[37]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(9, t2, s2, s3, s0, s1, rk[38]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_E(9, t3, s3, s0, s1, s2, rk[39]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>LAST_E(10, ct[0], t0, t1, t2, t3, rk[40]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>LAST_E(10, ct[1], t1, t2, t3, t0, rk[41]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>LAST_E(10, ct[2], t2, t3, t0, t1, rk[42]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>LAST_E(10, ct[3], t3, t0, t1, t2, rk[43]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:1.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>}<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>We have omitted the middle rounds, but the
pattern is clear nevertheless. The </span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>AES</span></b><span lang=EN-US> program gives the complete code.
Note how the output of the rounds alters between the “</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>s</span><span
lang=EN-US>” state variables and the “</span><span lang=EN-US style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>t</span><span
lang=EN-US>” state variables and how these are used as input to the following
round.</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The last round is somewhat special because
it uses a separate table (Te4):</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>#define <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>LAST_E(r, out, in0, in1, in2, in3, key) </span></b><span
style='mso-spacerun:yes'>       </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:1.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span><b
style='mso-bidi-font-weight:normal'><span style='color:maroon'>out</span></b> =
(Te4[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in0</span></b>
&gt;&gt; 24)<span style='mso-spacerun:yes'>       </span>] &amp; 0xff000000)
^<span style='mso-spacerun:yes'>       </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>       
</span>(Te4[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in1</span></b>
&gt;&gt; 16) &amp; 0xff] &amp; 0x00ff0000) ^<span
style='mso-spacerun:yes'>       </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>       
</span>(Te4[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in2</span></b>
&gt;&gt;<span style='mso-spacerun:yes'>  </span>8) &amp; 0xff] &amp;
0x0000ff00) ^<span style='mso-spacerun:yes'>       </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>       
</span>(Te4[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in3</span></b><span
style='mso-spacerun:yes'>      </span>) &amp; 0xff] &amp; 0x000000ff) ^
key<span style='mso-spacerun:yes'>   </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>static const u32 Te4[256] = {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>0x63636363U, 0x7C7C7C7CU, 0x77777777U, 0x7B7B7B7BU,<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>0xF2F2F2F2U, 0x6B6B6B6BU, 0x6F6F6F6FU, 0xC5C5C5C5U,<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>0x30303030U, 0x01010101U, 0x67676767U, 0x2B2B2B2BU,<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>…<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:4.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Note how the plaintext (</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>XOR</span><span
lang=EN-US>ed with the round key portions) was used as the initial state (</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>s0</span><span
lang=EN-US>, …) and how the last round stores the state (</span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>t0</span><span
lang=EN-US>, …) as the ciphertext.</span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>Defining a Decryption Round</span></h2>

<p class=MsoNormal><span lang=EN-US>The only difference is that a different set
of tables are used (Td<i style='mso-bidi-font-style:normal'>n</i> versus Te<i
style='mso-bidi-font-style:normal'>n</i>):</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>#define ROUND_D(<b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>r</span></b>, <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>out</span></b>, <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>in0</span></b>, <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>in1</span></b>, <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>in2</span></b>, <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>in3</span></b>, <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>key</span></b>) \<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span><b
style='mso-bidi-font-weight:normal'><span style='color:maroon'>out</span></b> =
Td0[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in0</span></b>
&gt;&gt; 24)<span style='mso-spacerun:yes'>       </span>] ^<span
style='mso-spacerun:yes'>                </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>       
</span>Td1[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in1</span></b>
&gt;&gt; 16) &amp; 0xff] ^<span style='mso-spacerun:yes'>               
</span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>       
</span>Td2[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in2</span></b>
&gt;&gt;<span style='mso-spacerun:yes'>  </span>8) &amp; 0xff] ^<span
style='mso-spacerun:yes'>                </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>       
</span>Td3[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in3</span></b><span
style='mso-spacerun:yes'>      </span>) &amp; 0xff] ^ <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>key</span></b><span
style='mso-spacerun:yes'>            </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>#define LAST_D(<b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>r</span></b>, <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>out</span></b>, <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>in0</span></b>, <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>in1</span></b>, <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>in2</span></b>, <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>in3</span></b>, <b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>key</span></b>)<span
style='mso-spacerun:yes'>        </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span><b
style='mso-bidi-font-weight:normal'><span style='color:maroon'>out</span></b> =
(Td4[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in0</span></b>
&gt;&gt; 24)<span style='mso-spacerun:yes'>       </span>] &amp; 0xff000000)
^<span style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>  </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>       
</span>(Td4[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in1</span></b>
&gt;&gt; 16) &amp; 0xff] &amp; 0x00ff0000) ^<span
style='mso-spacerun:yes'>       </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>       
</span>(Td4[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in2</span></b>
&gt;&gt;<span style='mso-spacerun:yes'>  </span>8) &amp; 0xff] &amp;
0x0000ff00) ^<span style='mso-spacerun:yes'>       </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>       
</span>(Td4[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>in3</span></b><span
style='mso-spacerun:yes'>      </span>) &amp; 0xff] &amp; 0x000000ff) ^ <b
style='mso-bidi-font-weight:normal'><span style='color:maroon'>key</span></b><span
style='mso-spacerun:yes'>   </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>void AES_Decrypt(const u32 rk[], u32 pt[],
const u32 ct[]) {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>u32 s0, s1, s2, s3,<span style='mso-spacerun:yes'>  </span>t0, t1, t2,
t3;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>s0
= ct[0] ^ rk[0];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>s1
= ct[1] ^ rk[1];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>s2
= ct[2] ^ rk[2];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>s3
= ct[3] ^ rk[3];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(1, <b style='mso-bidi-font-weight:normal'><span
style='color:blue'>t0</span></b>, <b style='mso-bidi-font-weight:normal'><span
style='color:gray'>s0</span></b>, s3, s2, s1, rk[ 4]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(1, t1, s1, <b style='mso-bidi-font-weight:normal'><span
style='color:gray'>s0</span></b>, s3, s2, rk[ 5]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(1, t2, s2, s1, <b style='mso-bidi-font-weight:normal'><span
style='color:gray'>s0</span></b>, s3, rk[ 6]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(1, t3, s3, s2, s1, <b style='mso-bidi-font-weight:normal'><span
style='color:gray'>s0</span></b>, rk[ 7]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(2, s0, <b style='mso-bidi-font-weight:normal'><span
style='color:blue'>t0</span></b>, t3, t2, t1, rk[ 8]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(2, s1, t1, t0, t3, t2, rk[ 9]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(2, s2, t2, t1, t0, t3, rk[10]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(2, s3, t3, t2, t1, t0, rk[11]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>…<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(8, s0, t0, t3, t2, t1, rk[32]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(8, s1, t1, t0, t3, t2, rk[33]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(8, s2, t2, t1, t0, t3, rk[34]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(8, s3, t3, t2, t1, t0, rk[35]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(9, t0, s0, s3, s2, s1, rk[36]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(9, t1, s1, s0, s3, s2, rk[37]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(9, t2, s2, s1, s0, s3, rk[38]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>ROUND_D(9, t3, s3, s2, s1, s0, rk[39]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>LAST_D(10, pt[0], t0, t3, t2, t1, rk[40]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>LAST_D(10, pt[1], t1, t0, t3, t2, rk[41]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>LAST_D(10, pt[2], t2, t1, t0, t3, rk[42]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>LAST_D(10, pt[3], t3, t2, t1, t0, rk[43]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>After the last round the state is stored in
the plaintext and the decryption is complete.</span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>Key Expansion</span></h2>

<p class=MsoNormal><span lang=EN-US>Encryption relies on the two principles of <i
style='mso-bidi-font-style:normal'>confusion</i> and <i style='mso-bidi-font-style:
normal'>diffusion</i>. We obtain confusion by using S-boxes and diffusion by
using a <i style='mso-bidi-font-style:normal'>different</i> key for each round.
This expanded <i style='mso-bidi-font-style:normal'>key sequence</i> is
constructed from the original key using a special key S-box together with a bit
sequence that injects a bit in a different position for each round key:</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>static const u32 rcon[10] = {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span
style='mso-spacerun:yes'> </span>0x01000000, 0x02000000, 0x04000000,
0x08000000,<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span
style='mso-spacerun:yes'> </span>0x10000000, 0x20000000, 0x40000000, 0x80000000,<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span
style='mso-spacerun:yes'> </span>0x1B000000, 0x36000000};<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The round keys for encryption are
constructed in this way:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>void AES_KeySetupEnc(u32 rk[], const u32
Key[]) {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>int i;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>u32 temp;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>rk[0] = Key[0];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>rk[1] = Key[1];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>rk[2] = Key[2];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>rk[3] = Key[3];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>for (i=0; i&lt;10 ; i++) {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>temp<span style='mso-spacerun:yes'>  </span>= rk[3];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>rk[4] = rk[0] ^ rcon[i] ^<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>     
</span>(Te4[(temp &gt;&gt; 16) &amp; 0xff] &amp; 0xff000000) ^<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>     
</span>(Te4[(temp &gt;&gt;<span style='mso-spacerun:yes'>  </span>8) &amp;
0xff] &amp; 0x00ff0000) ^<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>     
</span>(Te4[(temp<span style='mso-spacerun:yes'>      </span>) &amp; 0xff]
&amp; 0x0000ff00) ^<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>     
</span>(Te4[(temp &gt;&gt; 24)<span style='mso-spacerun:yes'>       </span>]
&amp; 0x000000ff);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>rk[5] = rk[1] ^ rk[4];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>rk[6] = rk[2] ^ rk[5];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>rk[7] = rk[3] ^ rk[6];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>rk += 4;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>}<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The round keys for decryption start with
the round keys for encryption in reverse order and are then confused through
the S-boxes for decryption:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>void AES_KeySetupDec(u32 rk[], const u32
Key[]) {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>int i, j;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>u32 temp;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>AES_KeySetupEnc(rk, Key);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>/*
invert the order of the round keys: */<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>for (i = 0, j = 40; i &lt; j; i += 4, j -= 4) {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>temp = rk[i<span style='mso-spacerun:yes'>  </span>]; rk[i<span
style='mso-spacerun:yes'>  </span>] = rk[j<span style='mso-spacerun:yes'> 
</span>]; rk[j<span style='mso-spacerun:yes'>  </span>] = temp;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>temp = rk[i+1]; rk[i+1] = rk[j+1]; rk[j+1] = temp;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>temp = rk[i+2]; rk[i+2] = rk[j+2]; rk[j+2] = temp;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>temp = rk[i+3]; rk[i+3] = rk[j+3]; rk[j+3] = temp;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>#define INVERT(key)<span
style='mso-spacerun:yes'>                             </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>    </span><b
style='mso-bidi-font-weight:normal'><span style='color:maroon'>key</span></b> =
Td0[Te4[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>key</span></b>
&gt;&gt; 24)<span style='mso-spacerun:yes'>       </span>] &amp; 0xff] ^ \<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>     
</span><span style='mso-spacerun:yes'>    </span>Td1[Te4[(<b style='mso-bidi-font-weight:
normal'><span style='color:maroon'>key</span></b> &gt;&gt; 16) &amp; 0xff]
&amp; 0xff] ^ \<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>         
</span>Td2[Te4[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>key</span></b>
&gt;&gt;<span style='mso-spacerun:yes'>  </span>8) &amp; 0xff] &amp; 0xff] ^ \<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>         
</span>Td3[Te4[(<b style='mso-bidi-font-weight:normal'><span style='color:maroon'>key</span></b><span
style='mso-spacerun:yes'>      </span>) &amp; 0xff] &amp; 0xff]<span
style='mso-spacerun:yes'>   </span>\<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>for (i = 1; i &lt; 10; i++) {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>rk += 4;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>INVERT(rk[0]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>INVERT(rk[1]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>INVERT(rk[2]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>INVERT(rk[3]);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>}<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The MI-version of the key expansion goes
like this:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>SETUP-ENCRYPT-KEYS:<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>       </span>RK(00), KEY(01:4);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>       </span>RK(01), KEY(05:4);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>       </span>RK(02), KEY(09:4);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>       </span>RK(03), KEY(13:4);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, RK(03),<span
style='mso-spacerun:yes'>  </span>8, 8;<span style='mso-spacerun:yes'> 
</span>XOR<span style='mso-spacerun:yes'>     </span>L0(1:1), TE4(B), X'01';<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, RK(03), 16,
8;<span style='mso-spacerun:yes'>  </span>CPYBLA<span
style='mso-spacerun:yes'>  </span>L0(2:1), TE4(B);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, RK(03), 24,
8;<span style='mso-spacerun:yes'>  </span>CPYBLA<span
style='mso-spacerun:yes'>  </span>L0(3:1), TE4(B);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, RK(03),<span
style='mso-spacerun:yes'>  </span>0, 8;<span style='mso-spacerun:yes'> 
</span>CPYBLA<span style='mso-spacerun:yes'>  </span>L0(4:1), TE4(B);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>XOR<span style='mso-spacerun:yes'>          </span>RK(04), L0 <span
style='mso-spacerun:yes'>   </span>, RK(00);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>XOR<span style='mso-spacerun:yes'>          </span>RK(05), RK(04),
RK(01);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>XOR<span style='mso-spacerun:yes'>          </span>RK(06), RK(05),
RK(02);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>XOR<span style='mso-spacerun:yes'>          </span>RK(07), RK(06),
RK(03);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>…<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, RK(39),<span
style='mso-spacerun:yes'>  </span>8, 8;<span style='mso-spacerun:yes'> 
</span>XOR<span style='mso-spacerun:yes'>     </span>L0(1:1), TE4(B), X'36';<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, RK(39), 16,
8;<span style='mso-spacerun:yes'>  </span>CPYBLA<span
style='mso-spacerun:yes'>  </span>L0(2:1), TE4(B);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, RK(39), 24,
8;<span style='mso-spacerun:yes'>  </span>CPYBLA<span
style='mso-spacerun:yes'>  </span>L0(3:1), TE4(B);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, RK(39),<span
style='mso-spacerun:yes'>  </span>0, 8;<span style='mso-spacerun:yes'> 
</span>CPYBLA<span style='mso-spacerun:yes'>  </span>L0(4:1), TE4(B);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>XOR<span style='mso-spacerun:yes'>          </span>RK(40), L0<span
style='mso-spacerun:yes'>    </span>, RK(36);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>XOR<span style='mso-spacerun:yes'>          </span>RK(41), RK(40),
RK(37);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>XOR<span style='mso-spacerun:yes'>          </span>RK(42), RK(41),
RK(38);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>XOR<span style='mso-spacerun:yes'>          </span>RK(43), RK(42),
RK(39);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>…<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>INVERSION-FOR-DECRYPT:<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>EXCHBY<span style='mso-spacerun:yes'>       </span>SCHEDULE(001:16),
SCHEDULE(161:16);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>EXCHBY<span style='mso-spacerun:yes'>       </span>SCHEDULE(017:16),
SCHEDULE(145:16);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>EXCHBY<span style='mso-spacerun:yes'>       </span>SCHEDULE(033:16),
SCHEDULE(129:16);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>EXCHBY<span style='mso-spacerun:yes'>       </span>SCHEDULE(049:16),
SCHEDULE(113:16);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>EXCHBY<span style='mso-spacerun:yes'>       </span>SCHEDULE(065:16),
SCHEDULE(097:16);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>        </span>RN, 4; /* SKIP FIRST
(AND LAST) ROUND-KEY */<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>INVERT-MIX-COLS:<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>       </span>R, RK(RN);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, R, 0,8;<span
style='mso-spacerun:yes'>  </span>CPYBLA CB, TE4(B);<span
style='mso-spacerun:yes'>  </span>CPYBLA RK(RN), TD0(B);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, R, 8,8;<span
style='mso-spacerun:yes'>  </span>CPYBLA CB, TE4(B);<span
style='mso-spacerun:yes'>  </span>XOR(S) RK(RN), TD1(B);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, R,16,8;<span
style='mso-spacerun:yes'>  </span>CPYBLA CB, TE4(B);<span
style='mso-spacerun:yes'>  </span>XOR(S) RK(RN), TD2(B);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBTL<span style='mso-spacerun:yes'>       </span>B, R,24,8;<span
style='mso-spacerun:yes'>  </span>CPYBLA CB, TE4(B);<span
style='mso-spacerun:yes'>  </span>XOR(S) RK(RN), TD3(B);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>ADDN(S)<span style='mso-spacerun:yes'>      </span>RN, 1;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CMPNV(B)<span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>   </span>RN, 40/LO(INVERT-MIX-COLS), NLO(DONE);<o:p></o:p></span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>The Encryption/Decryption Process</span></h2>

<p class=MsoNormal><span lang=EN-US>There are four steps in the complete
process:</span></p>

<p class=MsoListBullet style='mso-list:l0 level1 lfo1'><![if !supportLists]><span
lang=EN-US style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=EN-US>Set up the encryption key
schedule with a given 16-byte key</span></p>

<p class=MsoListBullet style='mso-list:l0 level1 lfo1'><![if !supportLists]><span
lang=EN-US style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=EN-US>Encrypt a sequence of blocks of
16 bytes with the key schedule</span></p>

<p class=MsoListBullet style='mso-list:l0 level1 lfo1'><![if !supportLists]><span
lang=EN-US style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=EN-US>Set up the decryption key
schedule with the same 16-byte key</span></p>

<p class=MsoListBullet style='mso-list:l0 level1 lfo1'><![if !supportLists]><span
lang=EN-US style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=EN-US>Decrypt a sequence of blocks of
16 bytes with the key schedule</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>We define four separate functions
corresponding to each step. The </span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>MIAES</span></b><span lang=EN-US> program performs these
functions as selected by the </span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:blue'>OPERATION</span><span lang=EN-US style='color:blue'> </span></b><span
lang=EN-US>field of the </span><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>CONTROL</span><span
lang=EN-US> parameter:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL SPCPTR .PARM1 PARM;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD<span style='mso-spacerun:yes'>     
</span>CONTROL CHAR(256) BAS(.PARM1);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>DCL DD<span style='mso-spacerun:yes'>  </span><b style='mso-bidi-font-weight:
normal'><span style='color:blue'>OPERATION</span></b><span
style='mso-spacerun:yes'>   </span>CHAR(8) DEF(CONTROL)<span
style='mso-spacerun:yes'>  </span>POS( 1);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span
style='mso-spacerun:yes'>                    </span><span style='color:green'>/*<span
style='mso-spacerun:yes'>  </span><b style='mso-bidi-font-weight:normal'>EK</b><span
style='mso-spacerun:yes'>      </span>ENCRYPTION KEY SCHEDULE */</span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span
style='mso-spacerun:yes'>                    </span><span style='color:green'>/*<span
style='mso-spacerun:yes'>  </span><b style='mso-bidi-font-weight:normal'>E </b><span
style='mso-spacerun:yes'>      </span>ENCRYPT<span
style='mso-spacerun:yes'>           </span><span
style='mso-spacerun:yes'>      </span>*/</span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span
style='mso-spacerun:yes'>                    </span><span style='color:green'>/*<span
style='mso-spacerun:yes'>  </span><b style='mso-bidi-font-weight:normal'>DK</b><span
style='mso-spacerun:yes'>      </span>DECRYPTION KEY SCHEDULE */</span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span
style='mso-spacerun:yes'>                    </span><span style='color:green'>/*<span
style='mso-spacerun:yes'>  </span><b style='mso-bidi-font-weight:normal'>D </b><span
style='mso-spacerun:yes'>      </span>DECRYPT<span
style='mso-spacerun:yes'>                 </span>*/</span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>DCL DD<span style='mso-spacerun:yes'>  </span><b style='mso-bidi-font-weight:
normal'><span style='color:red'>KEY </span></b><span
style='mso-spacerun:yes'>       </span>CHAR(16) DEF(CONTROL)<span
style='mso-spacerun:yes'>  </span>POS( 9);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>DCL DD<span style='mso-spacerun:yes'>  </span>SCHEDULE<span
style='mso-spacerun:yes'>  </span>CHAR(176) DEF(CONTROL)<span
style='mso-spacerun:yes'>  </span>POS(25);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>       
</span>DCL DD RK(0:43) CHAR(4) DEF(SCHEDULE) POS(1);<span
style='mso-spacerun:yes'>  </span><span style='color:green'>/* private */</span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The following two parameters are the
plaintext block and the ciphertext block:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL SPCPTR .PARM2 PARM;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD<span style='mso-spacerun:yes'>     
</span>PT CHAR(16)<span style='mso-spacerun:yes'>  </span>BAS(.PARM2);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL SPCPTR .PARM3 PARM;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD<span style='mso-spacerun:yes'>     
</span>CT CHAR(16)<span style='mso-spacerun:yes'>  </span>BAS(.PARM3);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL OL PARMS (.PARM1, .PARM2, .PARM3) PARM
EXT MIN(3);<o:p></o:p></span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>Operating Modes</span></h2>

<p class=MsoNormal><span lang=EN-US>AES is a block cipher and can be operated
in two basic modes (and in very many variations on these):</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoListBullet style='mso-list:l0 level1 lfo1'><![if !supportLists]><span
lang=EN-US style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=EN-US>Electronic Codebook Mode (ECB)</span></p>

<p class=MsoListBullet style='mso-list:l0 level1 lfo1'><![if !supportLists]><span
lang=EN-US style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span lang=EN-US>Cipher Block Chaining Mode
(CBC)</span></p>

<h3 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level3 lfo2'><span
lang=EN-US>Electronic Codebook Mode</span></h3>

<p class=MsoListBullet style='margin-left:0cm;text-indent:0cm;mso-list:none;
tab-stops:36.0pt'><span lang=EN-US>Electronic codebook mode is the simplest way
to operator a block cipher like AES: A block of plaintext encrypts to a block
of ciphertext. Since the same block of plaintext always encrypts to the same
block of ciphertext it is possible (in theory at least) to create a <i
style='mso-bidi-font-style:normal'>code book</i> of plaintexts and
corresponding ciphertexts. With a 128-bit key, the code book will have 2<sup>128</sup>
entries - much too large to pre-compute and store (and this is just for one
key!), but the ‘codebook’ concept is still used.</span></p>

<p class=MsoListBullet style='margin-left:0cm;text-indent:0cm;mso-list:none;
tab-stops:36.0pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoListBullet style='margin-left:0cm;text-indent:0cm;mso-list:none;
tab-stops:36.0pt'><span lang=EN-US>A useful property of the ECB mode is that
each block encrypts independently and does not depend on its context. This is
important for encrypted files that must accessed randomly, e.g. as records in a
database. If the database is encrypted in ECB mode, then any record can be
added or modified independently of any other record. </span></p>

<p class=MsoListBullet style='margin-left:0cm;text-indent:0cm;mso-list:none;
tab-stops:36.0pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoListBullet style='margin-left:0cm;text-indent:0cm;mso-list:none;
tab-stops:36.0pt'><span lang=EN-US>The problem with ECB mode is that in most
real-world situations, fragments of messages tend to repeat. Different messages
may have bit-sequences in common (typically at the beginning and end of
messages - “Dear Mr. XXX” and “Sincerely yours…”). The decryption of Japanese
and German messages – pre Enigma – in WWII was based on this concept as
military messages are almost all boilerplate based and very regular. Computer
generated messages, like email, have highly regular structures. Reports may
have long strings of zeroes or spaces. Here is an example of a fragment of a
dump of a program:</span></p>

<p class=MsoListBullet style='margin-left:0cm;text-indent:0cm;mso-list:none;
tab-stops:36.0pt'><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>    
</span>DISPLAY/ALTER/DUMP<span
style='mso-spacerun:yes'>                                                                           
</span>04/12/01<span style='mso-spacerun:yes'>  </span>19:41:06<span
style='mso-spacerun:yes'>   </span>PAGE<span style='mso-spacerun:yes'>     
</span>1<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>MI PROGRAM<span
style='mso-spacerun:yes'>                   </span>SUBTYPE:<span
style='mso-spacerun:yes'>  </span>01<span style='mso-spacerun:yes'>     
</span>NAME:<span style='mso-spacerun:yes'>  </span>AESCALL<span
style='mso-spacerun:yes'>                             </span>ADDRESS:<span
style='mso-spacerun:yes'>  </span>1C233CCF17 000000<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>SEGMENT HEADER<span
style='mso-spacerun:yes'>   </span>(YYSGHDR)<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>TYPE<span style='mso-spacerun:yes'>  </span>0001<span
style='mso-spacerun:yes'>   </span>SIZE<span style='mso-spacerun:yes'> 
</span>0030<span style='mso-spacerun:yes'>   </span>NEWFLAGS<span
style='mso-spacerun:yes'>  </span>00<span style='mso-spacerun:yes'>  
</span>FLAGS<span style='mso-spacerun:yes'>  </span>90<span
style='mso-spacerun:yes'>   </span>DOMAIN<span style='mso-spacerun:yes'> 
</span>0001<span style='mso-spacerun:yes'>   </span>OBJECT<span
style='mso-spacerun:yes'>  </span>1C233CCF17 000000<span
style='mso-spacerun:yes'>   </span>SPACE<span style='mso-spacerun:yes'> 
</span>12CCEB45F8 001000<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>EPA HEADER<span
style='mso-spacerun:yes'>   </span>(YYEPAHDR)<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>ATT1<span style='mso-spacerun:yes'>      </span>80<span
style='mso-spacerun:yes'>                   </span>JOPT<span
style='mso-spacerun:yes'>      </span>00<span
style='mso-spacerun:yes'>                   </span>TYPE<span
style='mso-spacerun:yes'>      </span>02<span
style='mso-spacerun:yes'>                   </span>STYP<span
style='mso-spacerun:yes'>      </span>01<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>NAME<span style='mso-spacerun:yes'>      </span>AESCALL<span
style='mso-spacerun:yes'>                                            
</span>SPATT<span style='mso-spacerun:yes'>     </span>80<span
style='mso-spacerun:yes'>    </span><span
style='mso-spacerun:yes'>               </span>SPIN<span
style='mso-spacerun:yes'>      </span>00<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>SPSZ<span style='mso-spacerun:yes'>      </span>00001000<span
style='mso-spacerun:yes'>             </span>PBAU<span
style='mso-spacerun:yes'>      </span>3F10<span
style='mso-spacerun:yes'>                 </span>DVER<span
style='mso-spacerun:yes'>      </span>3600<span
style='mso-spacerun:yes'>                 </span>TIME<span
style='mso-spacerun:yes'>      </span>04/12/01<span style='mso-spacerun:yes'> 
</span>19:38:16<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>UPSG<span style='mso-spacerun:yes'>      </span>053B6FC9F9 000000<span
style='mso-spacerun:yes'>    </span>AGSG<span style='mso-spacerun:yes'>     
</span>0000000000 000000<span style='mso-spacerun:yes'>    </span>CTSG<span
style='mso-spacerun:yes'>      </span>01AA965C51 000000<span
style='mso-spacerun:yes'>    </span>OSG<span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>     </span>1C233CCF17 001000<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>RCV2<span style='mso-spacerun:yes'>      </span>1000<span
style='mso-spacerun:yes'>                 </span>ASP<span
style='mso-spacerun:yes'>       </span>0000<span
style='mso-spacerun:yes'>                 </span>PERF<span
style='mso-spacerun:yes'>      </span>01000000<span
style='mso-spacerun:yes'>             </span>MDTS<span
style='mso-spacerun:yes'>      </span>04/12/01<span style='mso-spacerun:yes'> 
</span>19:38:31<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>JPSG<span style='mso-spacerun:yes'>      </span>0000000000 000000<span
style='mso-spacerun:yes'>    </span>CBSG<span style='mso-spacerun:yes'>     
</span>0000000000 000000<span style='mso-spacerun:yes'>    </span>JID<span
style='mso-spacerun:yes'>       </span>00000000000000000000<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>OWAU<span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'>    </span>FF1C<span
style='mso-spacerun:yes'>                 </span>IPL NUM<span
style='mso-spacerun:yes'>   </span>00000031<span
style='mso-spacerun:yes'>             </span>AL1S<span
style='mso-spacerun:yes'>      </span>0000000000 000000<span
style='mso-spacerun:yes'>    </span>GRAU<span style='mso-spacerun:yes'>     
</span>0000<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>GRP<span style='mso-spacerun:yes'>       </span>000000000000<span
style='mso-spacerun:yes'>         </span>MAXS<span
style='mso-spacerun:yes'>      </span>0004<span
style='mso-spacerun:yes'>                 </span>INFO<span
style='mso-spacerun:yes'>      </span>0000000000000000<span
style='mso-spacerun:yes'>     </span>ATT2<span style='mso-spacerun:yes'>     
</span>E0<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>COLB<span style='mso-spacerun:yes'>      </span>01<span
style='mso-spacerun:yes'>                   </span>LEVL<span
style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'> </span>00000000<span
style='mso-spacerun:yes'>             </span>USCNT<span
style='mso-spacerun:yes'>     </span>0000<span
style='mso-spacerun:yes'>                 </span>USDAY<span
style='mso-spacerun:yes'>     </span>0000<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>DJID<span style='mso-spacerun:yes'>      </span>00<span
style='color:yellow;background:yellow;mso-highlight:yellow'>////////////////</span><span
style='mso-spacerun:yes'>   </span>DENP<span style='mso-spacerun:yes'>     
</span>0000000000 000000<span style='mso-spacerun:yes'>    </span>POSG<span
style='mso-spacerun:yes'>      </span>0000000000 000000<span
style='mso-spacerun:yes'>    </span>DIRP<span style='mso-spacerun:yes'>     
</span>0000000000 000000<span style='mso-spacerun:yes'>  </span><span
style='color:yellow;background:yellow;mso-highlight:yellow'>////////////////</span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Encrypted in ECB mode it looks like this</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>g)..lF..ds..FãÛûî.xUHu.åzÜå..&lt;Îkß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦|¾Nµ.ø.Ä£T
Pú2.^q/¸.r¨Ú.&lt;.¹Ô%vxàSL¥Ñ[.ÃÁ]©.ys¡ûg<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>..ÿ8«.Ìî+úiõ.º{Ã..Ýù.4û.È...YxßE]ø=Í!..ÈY..fÓù°.©üñ²'uºíTHRO.&lt;.êß\Ôd.¨Õ&gt;.jÜÑd¦|¾Ì%bý?W.]..ßp².Ðµþ43·_..Üü.¾F6.¥®ÖÀvÁ'..¢'÷E).È.Wß\Ôd.¨Õ&gt;.jÜÑd¦<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>)).ß}vT.ÕûpãÍ8jð4ìÏ¥H±_.é.·.k|u¸ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>ÎrF¢ùt.ûè.y£û%..3..N.OøÌÉ4ßì.û.Ub.d..üûå.à.ó&quot;È..@..ÚbËI.NÙøÉ.T¸(.dÕÁ`.ê&gt;µïJl.Ñ3%Ï³¼.zF.P..k.®d..zêú..ð.á.¬.&quot;×|p?÷=cËboxãe¨ÁùKÆD&amp;ß\Ôd.¨Õ&gt;.jÜÑd¦<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>lt.V.ÇáýÁ..Â.l9Ï´Þbw|&quot;H¨Ìh.è÷Uº.ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>!H6..Ä5.ê.÷4,#.Nß\Ôd.¨Õ&gt;.jÜÑd¦|¾Å.2H.GIlÂÂ.B¥ÚïÎß\Ôd.¨Õ&gt;.jÜÑd¦|¾=7.².õ&amp;W.E&amp;ÿh.Ã¸ß\Ôd.¨Õ&gt;.jÜÑd¦|¾.Fgäu...².{sªjy_ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>j¥a.å@...óR.ÿ..chë´è.Æi¤Ï..´£...ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦|¾t­¥6ý?¬7å.¸%.¨Ûéß\Ôd.¨Õ&gt;.jÜÑd¦|¾.?.Hi.®×Þ.pé;.?`ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>àß°q­¡.ðÀ1®ã}W}(Î¨.sL; bÑ1í³ê4á.÷..=èmò.;Æ*f½`n°B+-.:L¯.TÆø..j3×¶¦;}.ÅàFü·w.óÑ.
ß\Ôd.¨Õ&gt;.jÜÑd¦|¾.Th..±¨t/.Ý!ðÝ.dÝ°ô....ÆEmR¥.pf»ß\Ôd.¨Õ&gt;.jÜÑd¦<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>L.èÇø..c.3|.L\..È.=¾Ò.Ê¯-....[·G.Y¼äxeh..ÎR¿K¨.bÖ¢.Ó.â..¤`Z§=&quot;©ayÊ.¾0Ç{:2L)..Â7O\.ã.^.É.U.B¯ì°e.t'ø.?......Êâ&quot;.&lt;X,..H&lt;¿.L..Ä©.&nbsp;Wß\Ôd.¨Õ&gt;.jÜÑd¦<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>K.gñ..Þ&gt;*íµQf§´a¦.ÊÈ.&gt;\*a,H;.ç@B&amp;Aã?$.÷!b.nVàù.ªB+-.:L¯.TÆø..j3×°.ØÉ.Ûê£.bÉØD\m.wÖ®³m:Ç=dHÃ.Æ.qÃE¤²òa..r¾..DÀ.§.ÎûÍiü...3Õ.].ûÉøß\Ôd.¨Õ&gt;.jÜÑd¦<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>,&nbsp;.IY.V±...Ð¥z.}.dfrØ.ù.IèN¬....!;...&amp;[­¤³×¦ÑÁ8.Ö¢.Ó.â..¤`Z§=&quot;©a¦ö°Ë.±..÷õCÅ'Î.JkÇ.õ.À.j&amp;.Ä.E©µ¢ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>ÉÍï.º.²]æ³.ö.Ã.d.í.ñl1xX&lt;k&amp;.ydF'Pt.îmý,.íUÁ6.ºT.YÜw]...ö&quot;\.,Ãÿ¹¤­|5_zÇOFÃ..äD.zX.Ê½h~t.´.$]FÓÅ¦«ô³'¼{...¢qP¹[­I.ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>d/Ö-J:ÞaÚJ`þ..a..döR.e...å}]q..¨Üña6·À³}L.ø.Öù.ô..WØ7á¿Íf´Ýz.q....6F&gt;.i.._âÑ.Þ.ôó:.Tr}½5G.hÅg].ª§m&gt;ÏÔH¶oqË.&quot;PMt§ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>B8._¿..ø..Ï6à÷fôß\Ôd.¨Õ&gt;.jÜÑd¦|¾·ò¬BWÖ¯)UA@|
LO(ÖÀvÁ'..¢'÷E).È.W¾.Þ.JûWazlö..AG#ß\Ôd.¨Õ&gt;.jÜÑd¦|¾Ú2.ºì.&lt;¤e.ÑèÛ..[ß\Ôd.¨Õ&gt;.jÜÑd¦|¾ß\Ôd.¨Õ&gt;.jÜÑd¦<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>ýsÄ&amp;,­Æ\ù`¥..áxò<span
style='background:yellow;mso-highlight:yellow'>ß\Ôd.¨Õ&gt;.jÜÑd¦</span>|¾úAtÂó.ª..ë«k.Õï.Ö¢.Ó.â..¤`Z§=&quot;©am§.q!0.ç&amp;..×5·ï..Ê½h~t.´.$]FÓÅ¦«,¤Pbd..}æ_µºéöãÉ..jj`t%¶Ò..HÎ.éð<span
style='background:yellow;mso-highlight:yellow'>ß\Ôd.¨Õ&gt;.jÜÑd¦</span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:4.5pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:5.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>The structure of the plaintext “shines”
through. Especially the sequence </span><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console";background:yellow;
mso-highlight:yellow'>ß\Ôd.¨Õ&gt;.jÜÑd¦</span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt'> </span><span lang=EN-US><span
style='mso-spacerun:yes'> </span>that very likely corresponds to a string of
spaces. Even the structure itself may give the attacker significant information
(he might guess that it is a program dump).</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>A more serious problem with ECB is that the
attacker could modify the encrypted message without knowing the key (or even
the algorithm). Based on any structure that may be evident, the attacker could
exchange 16-byte blocks and thus alter the message in a way that may be hard to
detect as the blocks would decrypt to reasonable plaintext. The solution to
this problem is a technique called <i style='mso-bidi-font-style:normal'>block
chaining</i>. </span></p>

<h3 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level3 lfo2'><span
lang=EN-US>Cipher Block Chaining Mode</span></h3>

<p class=MsoNormal><span lang=EN-US>In cipher block chaining mode, the
plaintext block is </span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>XOR</span><span lang=EN-US>ed with the
previous ciphertext block (the <i style='mso-bidi-font-style:normal'>chaining</i>
value) before it is encrypted. The very first plaintext block is </span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>XOR</span><span
lang=EN-US>ed with an <i style='mso-bidi-font-style:normal'>initial value
vector</i>. The initial value should be different for each message (could be a
timestamp or a message identifier or some such) but does not need to be kept
secret. This lack of secrecy is usually a surprise to most people; but imagine
a message consisting of 100 blocks. Block number 100 is </span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>XOR</span><span
lang=EN-US>ed with the ciphertext of block number 99; block number 99 is </span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>XOR</span><span
lang=EN-US>ed with the ciphertext of block number 98, and so on. Thus, since
the ciphertext is known, all the chaining values for blocks 100, 99, 98, etc
back to and including block number 2 are known by the attacker, so not much is
gained by keeping the first chaining value secret.</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Decryption is completed by </span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>XOR</span><span
lang=EN-US>ing the decrypted plaintext with the initialization vector the first
time, then with the previous ciphertext block for all succeeding blocks until
the end of the message.</span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>The File Encryption Program, </span><span lang=EN-US
style='font-family:"Lucida Console";color:maroon'>MIFAES</span></h2>

<p class=MsoNormal><span lang=EN-US>The following program (we have omitted the
declarations of I/O, see Chapter 12) encrypts/decrypts a file. I use a record
length of 144 bytes (a multiple of 16 bytes) for simplicity</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:7.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD INBUF<span
style='mso-spacerun:yes'>  </span>CHAR(144) BAS(.IFCB-INBUF);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD PADDED-INBUF CHAR(<b
style='mso-bidi-font-weight:normal'><span style='color:red'>144</span></b>);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD I BIN(4);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD OUTBUF CHAR(144) BAS(.OFCB-OUTBUF);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD PADDED-OUTBUF CHAR(144);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD MACHINE-DATA CHAR(8);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD CHAIN CHAR(16);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DCL DD SALT<span
style='mso-spacerun:yes'>  </span>CHAR(16);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>DCL DD SALT-FILE CHAR(10) DEF(SALT) POS(1);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>DCL DD SALT-TIME CHAR(12) DEF(SALT) POS(5);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console";color:green'>/**************************************************************/<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>ENTRY * (PARMS) EXT;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>OPEN-INPUT-FILE:<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>…<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>OPEN-OUTPUT-FILE:<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>…<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>SET-KEY:<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>      </span>KEY, X'<b
style='mso-bidi-font-weight:normal'><span style='color:red'>34F2A96B3C110E01770BEC45DC4828CD</span></b>';<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CMPBLA(B)<span style='mso-spacerun:yes'>   </span>PARM-GENERAL, &quot;<b
style='mso-bidi-font-weight:normal'><span style='color:red'>E</span></b>&quot;/EQ(ENCRYPT-THE-FILE);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CMPBLA(B)<span style='mso-spacerun:yes'>   </span>PARM-GENERAL, &quot;<b
style='mso-bidi-font-weight:normal'><span style='color:red'>D</span></b>&quot;/EQ(DECRYPT-THE-FILE);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>…<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>ENCRYPT-THE-FILE:<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>MATMDATA<span style='mso-spacerun:yes'>    </span>MACHINE-DATA,
X'0000';<span style='mso-spacerun:yes'>   </span><span style='color:green'>/*
get timestamp for initial vector */<o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>      </span>SALT-FILE, IFCB-MEMBER;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CVTHC<span style='mso-spacerun:yes'>       </span>SALT-TIME,
MACHINE-DATA(1:6);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>      </span>CHAIN, SALT;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLAP<span style='mso-spacerun:yes'>     </span>OPERATION,
&quot;EK&quot;, &quot; &quot;; <span style='color:green'>/* SETUP KEY SCHEDULE
*/</span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CALLX<span style='mso-spacerun:yes'>      </span>.MIAES, MIAES, *;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLAP<span style='mso-spacerun:yes'>     </span>OPERATION, &quot;E
&quot;, &quot; &quot;; <span style='color:green'>/* ENCRYPT */</span><o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>GET-PLAIN-RECORD:<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> </span><span
style='mso-spacerun:yes'>   </span>CALLX<span style='mso-spacerun:yes'>     
</span>.SEPT(GET-ENTRY), GET-OPERATION, *;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLAP<span style='mso-spacerun:yes'>     </span>PADDED-INBUF, INBUF,
&quot; &quot;;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>       </span>I, 1;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>ENCRYPT-BLOCK:<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>      </span>PT,
PADDED-INBUF(I:16);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>      </span>PT, CHAIN;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CALLX<span style='mso-spacerun:yes'>      </span>.MIAES, MIAES, *;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>      </span>OUTBUF(I:16), CT;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>      </span>CHAIN, CT;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>ADDN(S)<span style='mso-spacerun:yes'>     </span>I, 16;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CMPNV(B)<span style='mso-spacerun:yes'>    </span>I, <b
style='mso-bidi-font-weight:normal'><span style='color:red'>145</span></b>/LO(ENCRYPT-BLOCK);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CALLX<span style='mso-spacerun:yes'>      </span>.SEPT(PUT-ENTRY),
PUT-OPERATION, *;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>B<span style='mso-spacerun:yes'>           </span>GET-PLAIN-RECORD;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DECRYPT-THE-FILE:<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>      </span>CHAIN, SALT;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLAP<span style='mso-spacerun:yes'>     </span>OPERATION,
&quot;DK&quot;, &quot; &quot;; <span style='color:green'>/* SETUP KEY SCHEDULE
*/<o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CALLX<span style='mso-spacerun:yes'>      </span>.MIAES, MIAES, *;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLAP<span style='mso-spacerun:yes'>     </span>OPERATION, &quot;D
&quot;, &quot; &quot;; <span style='color:green'>/* DECRYPT */<o:p></o:p></span></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>GET-CIPHER-RECORD:<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CALLX<span style='mso-spacerun:yes'>      </span>.SEPT(GET-ENTRY),
GET-OPERATION, *;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYNV<span style='mso-spacerun:yes'>       </span>I, 1;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>DECRYPT-BLOCK:<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>      </span>CT, INBUF(I:16);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CALLX<span style='mso-spacerun:yes'>      </span>.MIAES, MIAES, *;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>XOR(S)<span style='mso-spacerun:yes'>      </span>PT, CHAIN;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>      </span>PADDED-OUTBUF(I:16),
PT;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>      </span>CHAIN, CT;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>ADDN(S)<span style='mso-spacerun:yes'>     </span>I, 16;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CMPNV(B)<span style='mso-spacerun:yes'>    </span>I, <b
style='mso-bidi-font-weight:normal'><span style='color:red'>145</span></b>/LO(DECRYPT-BLOCK);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CPYBLA<span style='mso-spacerun:yes'>      </span>OUTBUF, PADDED-OUTBUF;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CALLX<span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>   </span>.SEPT(PUT-ENTRY), PUT-OPERATION, *;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>B<span style='mso-spacerun:yes'>           </span>GET-CIPHER-RECORD;<o:p></o:p></span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>Encryption/Decryption Speed</span></h2>

<p class=MsoNormal><span lang=EN-US>We tested the program on a large spoolfile,
which we first copied to a database file:</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>===&gt; CPYSPLF QPCSMPRT TEXTFILE<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>===&gt; CALL MIFAES PARM(TEXTFILE LSVALGAARD
ENCRFILE LSVALGAARD <b style='mso-bidi-font-weight:normal'><span
style='color:blue'>ENCRYPT</span></b>)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Where </span><span lang=EN-US
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>TEXTFILE</span><span
lang=EN-US> and </span><span lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>ENCRFILE</span><span lang=EN-US> were
defined with a record length of 144 bytes and no format check. For a file with
3,678,208 bytes (25,225 records) the speed was (on a 150) as follows:</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-US>I/O<span
style='mso-spacerun:yes'>  </span><span style='mso-tab-count:3'>                                     </span>20
seconds</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-US>Call of empty </span><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>MIAES</span><span
lang=EN-US><span style='mso-tab-count:1'>          </span>12 seconds</span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=EN-US>Encrypt<span
style='mso-tab-count:3'>                               </span>37 seconds<span
style='mso-spacerun:yes'>  </span>(100 Kb/second)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:6.0pt;mso-bidi-font-size:
10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>These times are pretty evenly distributed.
You can improve the performance (if needed) by modifying </span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console";color:maroon'>MIAES</span></b><span
lang=EN-US> to deal with blocks longer than 16 bytes, or by using the <i
style='mso-bidi-font-style:normal'>C</i>-version (which is up to three times faster),
but it is usually not worth the effort. Decryption proceeds at the same speed
as encryption.</span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>Compiling and Binding the </span><span lang=EN-US style='font-style:
normal'>C</span><span lang=EN-US>-Programs</span></h2>

<p class=MsoNormal><span lang=EN-US>Creating an ILE <i style='mso-bidi-font-style:
normal'>C</i>-program is a bit more complicated than creating an OPM program.
Here are the two CL-programs that I used to create the C-module </span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console";color:maroon'>AES </span></b><span
lang=EN-US>and its test program </span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>AESTEST</span></b><span lang=EN-US>:</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>MKAES</span></b><span lang=EN-US style='font-size:8.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>:<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>PGM<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CRTCMOD MODULE(AES) SRCFILE(QCSRC) OUTPUT(*PRINT) +<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span
style='mso-spacerun:yes'>                        </span>OPTION(*NOSHOWINC)
DBGVIEW(*ALL)<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>ENDPGM<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Lucida Console";
color:maroon'>MKAESTST</span></b><span lang=EN-US style='font-size:8.0pt;
mso-bidi-font-size:10.0pt;font-family:"Lucida Console"'>:<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>PGM<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CRTCMOD MODULE(AESTEST) SRCFILE(QCSRC) OUTPUT(*PRINT) +<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span
style='mso-spacerun:yes'>                         </span>OPTION(*NOSHOWINC)
DBGVIEW(*ALL)<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CRTPGM<span style='mso-spacerun:yes'>  </span>PGM(AESTEST)
MODULE(*CURLIB/AESTEST *CURLIB/AES) +<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span
style='mso-spacerun:yes'>                          </span>ACTGRP(*CALLER)<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>CHGPGM<span style='mso-spacerun:yes'>  </span>PGM(AESTEST) OPTIMIZE(<b
style='mso-bidi-font-weight:normal'><span style='color:maroon'>*FULL</span></b>)<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>ENDPGM<o:p></o:p></span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>The </span><span lang=EN-US style='font-family:"Lucida Console";
color:maroon'>AES</span><span lang=EN-US> </span><span lang=EN-US
style='font-style:normal'>C</span><span lang=EN-US>-Program</span></h2>

<p class=MsoNormal><span lang=EN-US>Below is the mainline code from the <i
style='mso-bidi-font-style:normal'>C</i>-version of AES operated in ECB mode:</span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>#define COPY(to, from, length) for (i=0;
i&lt;length; i++) to[i] = from[i]<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>void AES(const char *oper, const char
*key<span style='mso-spacerun:yes'>  </span>, char *schedule,<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span
style='mso-spacerun:yes'>                                 </span>char *plain,
char *cipher) {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>u32 rK[44];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>u32 pt[4], ct[4];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>u32 *cK, *cS, *cP, *cC;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>int i;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>cK
= (u32*) key;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>cS
= (u32*) schedule;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>cP
= (u32*) plain;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>cC
= (u32*) cipher;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:1.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>if
(oper[0] == 'E') {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>     
</span>if (oper[1] == 'K') {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>         
</span>AES_KeySetupEnc(rK, cK);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>         
</span>COPY(cS, rK, 44);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>     
</span>}<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>     
</span>else {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>         
</span>COPY(rK, cS, 44);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>         
</span>COPY(pt, cP, 4);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>         
</span>AES_Encrypt(rK, pt, ct);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>         
</span>COPY(cC, ct, 4);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>     
</span>}<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>else<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:1.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>if
(oper[0] == 'D') {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>     
</span>if (oper[1] == 'K') {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>         
</span>AES_KeySetupDec(rK, cK);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>         
</span>COPY(cS, rK, 44);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>     
</span>}<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>     
</span>else {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>         
</span>COPY(rK, cS, 44);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>         
</span>COPY(ct, cC, 4);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>         
</span>AES_Decrypt(rK, pt, ct);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>         
</span>COPY(cP, pt, 4);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>     
</span>}<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>}<o:p></o:p></span></p>

<h2 style='margin-left:0cm;text-indent:0cm;mso-list:l1 level2 lfo2'><span
lang=EN-US>The </span><span lang=EN-US style='font-family:"Lucida Console";
color:maroon'>AESTEST</span><span lang=EN-US><span style='mso-spacerun:yes'> 
</span>Testprogram</span></h2>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>#include &lt;stdio.h&gt;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>#include &lt;string.h&gt;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>void printHex(char s[]) {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>int i;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>char ch;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>for (i=0; i&lt;16; i++) {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>   
</span>ch = (s[i]) &amp; 0xff; printf(&quot;%2.2X&quot;, ch);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>printf(&quot;\n&quot;);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>}<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>int main(void) {<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>char key<span style='mso-spacerun:yes'>  
</span>[16]={0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span
style='mso-spacerun:yes'>                   </span>0x08,0x09,0x0a,0x0b,0x0c,0x0d,0x0e,0x0f};<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>char rkeys[176];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>char cipher[16];<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>char plain [16]={0x00,0x11,0x22,0x33,0x44,0x55,0x66,0x77,<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span
style='mso-spacerun:yes'>                  
</span>0x88,0x99,0xaa,0xbb,0xcc,0xdd,0xee,0xff};<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>AES (&quot;EK&quot;, key, rkeys, plain, cipher);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>AES (&quot;E &quot;, key, rkeys, plain, cipher);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>printHex(cipher);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>AES (&quot;DK&quot;, key, rkeys, plain, cipher);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>AES (&quot;D &quot;, key, rkeys, plain, cipher);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>printHex(plain);<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>getchar();<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'><span style='mso-spacerun:yes'> 
</span>return 0;<o:p></o:p></span></p>

<p class=MsoPlainText><span lang=EN-US style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:"Lucida Console"'>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

</div>

</body>

</html>
